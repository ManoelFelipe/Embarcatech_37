<?xml version='1.0' encoding='UTF-8' standalone='no'?>
<doxygen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="compound.xsd" version="1.13.2" xml:lang="en-US">
  <compounddef id="_atividade__04_8c" kind="file" language="C++">
    <compoundname>Atividade_04.c</compoundname>
    <includes local="no">stdio.h</includes>
    <includes local="no">string.h</includes>
    <includes local="yes">pico/stdlib.h</includes>
    <includes local="yes">hardware/gpio.h</includes>
    <includes local="yes">hardware/timer.h</includes>
    <includes local="yes">hardware/i2c.h</includes>
    <includes refid="ssd1306__i2c_8h" local="yes">ssd1306_i2c.h</includes>
    <includes refid="ssd1306_8h" local="yes">ssd1306.h</includes>
    <includes refid="ssd1306__font_8h" local="yes">ssd1306_font.h</includes>
    <incdepgraph>
      <node id="10">
        <label>ssd1306.h</label>
        <link refid="ssd1306_8h_source"/>
        <childnode refid="8" relation="include">
        </childnode>
      </node>
      <node id="11">
        <label>ssd1306_font.h</label>
        <link refid="ssd1306__font_8h_source"/>
      </node>
      <node id="8">
        <label>ssd1306_i2c.h</label>
        <link refid="ssd1306__i2c_8h_source"/>
        <childnode refid="9" relation="include">
        </childnode>
        <childnode refid="4" relation="include">
        </childnode>
        <childnode refid="7" relation="include">
        </childnode>
      </node>
      <node id="1">
        <label>C:/Users/manoe/OneDrive/TI/EmbarcaTech/Segunda Fase/01_Unid.01_Microcontrolador/Atividades/Cap_04/Atividade_04/Atividade_04/src/Atividade_04.c</label>
        <link refid="_atividade__04_8c"/>
        <childnode refid="2" relation="include">
        </childnode>
        <childnode refid="3" relation="include">
        </childnode>
        <childnode refid="4" relation="include">
        </childnode>
        <childnode refid="5" relation="include">
        </childnode>
        <childnode refid="6" relation="include">
        </childnode>
        <childnode refid="7" relation="include">
        </childnode>
        <childnode refid="8" relation="include">
        </childnode>
        <childnode refid="10" relation="include">
        </childnode>
        <childnode refid="11" relation="include">
        </childnode>
      </node>
      <node id="5">
        <label>hardware/gpio.h</label>
      </node>
      <node id="7">
        <label>hardware/i2c.h</label>
      </node>
      <node id="6">
        <label>hardware/timer.h</label>
      </node>
      <node id="4">
        <label>pico/stdlib.h</label>
      </node>
      <node id="2">
        <label>stdio.h</label>
      </node>
      <node id="9">
        <label>stdlib.h</label>
      </node>
      <node id="3">
        <label>string.h</label>
      </node>
    </incdepgraph>
    <sectiondef kind="define">
      <memberdef kind="define" id="_atividade__04_8c_1ad12a564ad91765abf118b1a1c935a79b" prot="public" static="no">
        <name>RED_TIME_SEC</name>
        <initializer>10</initializer>
        <briefdescription>
<para>Tempo total de sinal vermelho (s) </para>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/Users/manoe/OneDrive/TI/EmbarcaTech/Segunda Fase/01_Unid.01_Microcontrolador/Atividades/Cap_04/Atividade_04/Atividade_04/src/Atividade_04.c" line="48" column="9" bodyfile="C:/Users/manoe/OneDrive/TI/EmbarcaTech/Segunda Fase/01_Unid.01_Microcontrolador/Atividades/Cap_04/Atividade_04/Atividade_04/src/Atividade_04.c" bodystart="48" bodyend="-1"/>
      </memberdef>
      <memberdef kind="define" id="_atividade__04_8c_1a4807eaf5581317c4277f82c741f105ac" prot="public" static="no">
        <name>GREEN_TIME_SEC</name>
        <initializer>10</initializer>
        <briefdescription>
<para>Tempo total de sinal verde (s) </para>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/Users/manoe/OneDrive/TI/EmbarcaTech/Segunda Fase/01_Unid.01_Microcontrolador/Atividades/Cap_04/Atividade_04/Atividade_04/src/Atividade_04.c" line="50" column="9" bodyfile="C:/Users/manoe/OneDrive/TI/EmbarcaTech/Segunda Fase/01_Unid.01_Microcontrolador/Atividades/Cap_04/Atividade_04/Atividade_04/src/Atividade_04.c" bodystart="50" bodyend="-1"/>
      </memberdef>
      <memberdef kind="define" id="_atividade__04_8c_1aa878f52b8595a099574f3a1c12717b73" prot="public" static="no">
        <name>YELLOW_TIME_SEC</name>
        <initializer>3</initializer>
        <briefdescription>
<para>Tempo total de sinal amarelo (s) </para>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/Users/manoe/OneDrive/TI/EmbarcaTech/Segunda Fase/01_Unid.01_Microcontrolador/Atividades/Cap_04/Atividade_04/Atividade_04/src/Atividade_04.c" line="52" column="9" bodyfile="C:/Users/manoe/OneDrive/TI/EmbarcaTech/Segunda Fase/01_Unid.01_Microcontrolador/Atividades/Cap_04/Atividade_04/Atividade_04/src/Atividade_04.c" bodystart="52" bodyend="-1"/>
      </memberdef>
      <memberdef kind="define" id="_atividade__04_8c_1a2b5f3cdada392dfc73422e30dc494bde" prot="public" static="no">
        <name>COUNTDOWN_START</name>
        <initializer>5</initializer>
        <briefdescription>
<para>Início da contagem regressiva (últimos segundos) </para>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/Users/manoe/OneDrive/TI/EmbarcaTech/Segunda Fase/01_Unid.01_Microcontrolador/Atividades/Cap_04/Atividade_04/Atividade_04/src/Atividade_04.c" line="54" column="9" bodyfile="C:/Users/manoe/OneDrive/TI/EmbarcaTech/Segunda Fase/01_Unid.01_Microcontrolador/Atividades/Cap_04/Atividade_04/Atividade_04/src/Atividade_04.c" bodystart="54" bodyend="-1"/>
      </memberdef>
      <memberdef kind="define" id="_atividade__04_8c_1ab9824ab080c30006c1baaa0dd7e863c5" prot="public" static="no">
        <name>LED_RED_PIN</name>
        <initializer>13</initializer>
        <briefdescription>
<para>Pino do LED vermelho. </para>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/Users/manoe/OneDrive/TI/EmbarcaTech/Segunda Fase/01_Unid.01_Microcontrolador/Atividades/Cap_04/Atividade_04/Atividade_04/src/Atividade_04.c" line="58" column="9" bodyfile="C:/Users/manoe/OneDrive/TI/EmbarcaTech/Segunda Fase/01_Unid.01_Microcontrolador/Atividades/Cap_04/Atividade_04/Atividade_04/src/Atividade_04.c" bodystart="58" bodyend="-1"/>
      </memberdef>
      <memberdef kind="define" id="_atividade__04_8c_1a0539be032702009fb24beec89c6fa0c0" prot="public" static="no">
        <name>LED_GREEN_PIN</name>
        <initializer>11</initializer>
        <briefdescription>
<para>Pino do LED verde. </para>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/Users/manoe/OneDrive/TI/EmbarcaTech/Segunda Fase/01_Unid.01_Microcontrolador/Atividades/Cap_04/Atividade_04/Atividade_04/src/Atividade_04.c" line="60" column="9" bodyfile="C:/Users/manoe/OneDrive/TI/EmbarcaTech/Segunda Fase/01_Unid.01_Microcontrolador/Atividades/Cap_04/Atividade_04/Atividade_04/src/Atividade_04.c" bodystart="60" bodyend="-1"/>
      </memberdef>
      <memberdef kind="define" id="_atividade__04_8c_1a5aec9d3b503fb1a30a21b16c7be86cff" prot="public" static="no">
        <name>LED_BLUE_PIN</name>
        <initializer>12</initializer>
        <briefdescription>
<para>Pino do LED azul (não usado) </para>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/Users/manoe/OneDrive/TI/EmbarcaTech/Segunda Fase/01_Unid.01_Microcontrolador/Atividades/Cap_04/Atividade_04/Atividade_04/src/Atividade_04.c" line="62" column="9" bodyfile="C:/Users/manoe/OneDrive/TI/EmbarcaTech/Segunda Fase/01_Unid.01_Microcontrolador/Atividades/Cap_04/Atividade_04/Atividade_04/src/Atividade_04.c" bodystart="62" bodyend="-1"/>
      </memberdef>
      <memberdef kind="define" id="_atividade__04_8c_1acbc26198121732a3c0a6888f8f4cb028" prot="public" static="no">
        <name>BUZZER_PIN1</name>
        <initializer>10</initializer>
        <briefdescription>
<para>Pino do buzzer principal. </para>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/Users/manoe/OneDrive/TI/EmbarcaTech/Segunda Fase/01_Unid.01_Microcontrolador/Atividades/Cap_04/Atividade_04/Atividade_04/src/Atividade_04.c" line="65" column="9" bodyfile="C:/Users/manoe/OneDrive/TI/EmbarcaTech/Segunda Fase/01_Unid.01_Microcontrolador/Atividades/Cap_04/Atividade_04/Atividade_04/src/Atividade_04.c" bodystart="65" bodyend="-1"/>
      </memberdef>
      <memberdef kind="define" id="_atividade__04_8c_1a6a9a564ed2b8f42d387f38dac7ed1b62" prot="public" static="no">
        <name>BUZZER_PIN2</name>
        <initializer>21</initializer>
        <briefdescription>
<para>Pino do buzzer secundário. </para>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/Users/manoe/OneDrive/TI/EmbarcaTech/Segunda Fase/01_Unid.01_Microcontrolador/Atividades/Cap_04/Atividade_04/Atividade_04/src/Atividade_04.c" line="67" column="9" bodyfile="C:/Users/manoe/OneDrive/TI/EmbarcaTech/Segunda Fase/01_Unid.01_Microcontrolador/Atividades/Cap_04/Atividade_04/Atividade_04/src/Atividade_04.c" bodystart="67" bodyend="-1"/>
      </memberdef>
      <memberdef kind="define" id="_atividade__04_8c_1aad905e2ee036ff31a5cc49b248361420" prot="public" static="no">
        <name>BUTTON_PIN1</name>
        <initializer>5</initializer>
        <briefdescription>
<para>Botão lado 1 (prioridade em empate) </para>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/Users/manoe/OneDrive/TI/EmbarcaTech/Segunda Fase/01_Unid.01_Microcontrolador/Atividades/Cap_04/Atividade_04/Atividade_04/src/Atividade_04.c" line="70" column="9" bodyfile="C:/Users/manoe/OneDrive/TI/EmbarcaTech/Segunda Fase/01_Unid.01_Microcontrolador/Atividades/Cap_04/Atividade_04/Atividade_04/src/Atividade_04.c" bodystart="70" bodyend="-1"/>
      </memberdef>
      <memberdef kind="define" id="_atividade__04_8c_1ab7676ab9bef15c1956c8163558e3ac44" prot="public" static="no">
        <name>BUTTON_PIN2</name>
        <initializer>6</initializer>
        <briefdescription>
<para>Botão lado 2. </para>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/Users/manoe/OneDrive/TI/EmbarcaTech/Segunda Fase/01_Unid.01_Microcontrolador/Atividades/Cap_04/Atividade_04/Atividade_04/src/Atividade_04.c" line="72" column="9" bodyfile="C:/Users/manoe/OneDrive/TI/EmbarcaTech/Segunda Fase/01_Unid.01_Microcontrolador/Atividades/Cap_04/Atividade_04/Atividade_04/src/Atividade_04.c" bodystart="72" bodyend="-1"/>
      </memberdef>
      <memberdef kind="define" id="_atividade__04_8c_1a2cade698267beb86ccaa38c14d35ab0f" prot="public" static="no">
        <name>I2C_SDA_PIN</name>
        <initializer>14</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/Users/manoe/OneDrive/TI/EmbarcaTech/Segunda Fase/01_Unid.01_Microcontrolador/Atividades/Cap_04/Atividade_04/Atividade_04/src/Atividade_04.c" line="75" column="9" bodyfile="C:/Users/manoe/OneDrive/TI/EmbarcaTech/Segunda Fase/01_Unid.01_Microcontrolador/Atividades/Cap_04/Atividade_04/Atividade_04/src/Atividade_04.c" bodystart="75" bodyend="-1"/>
      </memberdef>
      <memberdef kind="define" id="_atividade__04_8c_1a0e4e08bab2fb484136d18b067bef372c" prot="public" static="no">
        <name>I2C_SCL_PIN</name>
        <initializer>15</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/Users/manoe/OneDrive/TI/EmbarcaTech/Segunda Fase/01_Unid.01_Microcontrolador/Atividades/Cap_04/Atividade_04/Atividade_04/src/Atividade_04.c" line="76" column="9" bodyfile="C:/Users/manoe/OneDrive/TI/EmbarcaTech/Segunda Fase/01_Unid.01_Microcontrolador/Atividades/Cap_04/Atividade_04/Atividade_04/src/Atividade_04.c" bodystart="76" bodyend="-1"/>
      </memberdef>
    </sectiondef>
    <sectiondef kind="enum">
      <memberdef kind="enum" id="_atividade__04_8c_1aa0aafed44fec19806d8f9ad834be1248" prot="public" static="no" strong="no">
        <type></type>
        <name>state_t</name>
        <enumvalue id="_atividade__04_8c_1aa0aafed44fec19806d8f9ad834be1248ad2aaf0c286ae52532c96f716b3410aed" prot="public">
          <name>ST_RED</name>
          <initializer>= 0</initializer>
          <briefdescription>
          </briefdescription>
          <detaileddescription>
<para>Vermelho </para>
          </detaileddescription>
        </enumvalue>
        <enumvalue id="_atividade__04_8c_1aa0aafed44fec19806d8f9ad834be1248a3680d3e43be15ef8b428fe0a64956b90" prot="public">
          <name>ST_GREEN</name>
          <briefdescription>
          </briefdescription>
          <detaileddescription>
<para>Verde </para>
          </detaileddescription>
        </enumvalue>
        <enumvalue id="_atividade__04_8c_1aa0aafed44fec19806d8f9ad834be1248a7b5984aa066eb4676d7f8747429d5f3b" prot="public">
          <name>ST_YELLOW</name>
          <briefdescription>
          </briefdescription>
          <detaileddescription>
<para>Amarelo </para>
          </detaileddescription>
        </enumvalue>
        <briefdescription>
<para>Estados possíveis do semáforo. </para>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/Users/manoe/OneDrive/TI/EmbarcaTech/Segunda Fase/01_Unid.01_Microcontrolador/Atividades/Cap_04/Atividade_04/Atividade_04/src/Atividade_04.c" line="80" column="1" bodyfile="C:/Users/manoe/OneDrive/TI/EmbarcaTech/Segunda Fase/01_Unid.01_Microcontrolador/Atividades/Cap_04/Atividade_04/Atividade_04/src/Atividade_04.c" bodystart="80" bodyend="84"/>
      </memberdef>
    </sectiondef>
    <sectiondef kind="var">
      <memberdef kind="variable" id="_atividade__04_8c_1a27005362f402a15934db97feb762757a" prot="public" static="yes" mutable="no">
        <type>volatile <ref refid="_atividade__04_8c_1aa0aafed44fec19806d8f9ad834be1248" kindref="member">state_t</ref></type>
        <definition>volatile state_t current_state</definition>
        <argsstring></argsstring>
        <name>current_state</name>
        <initializer>= <ref refid="_atividade__04_8c_1aa0aafed44fec19806d8f9ad834be1248ad2aaf0c286ae52532c96f716b3410aed" kindref="member">ST_RED</ref></initializer>
        <briefdescription>
<para>Estado corrente do semáforo. </para>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/Users/manoe/OneDrive/TI/EmbarcaTech/Segunda Fase/01_Unid.01_Microcontrolador/Atividades/Cap_04/Atividade_04/Atividade_04/src/Atividade_04.c" line="87" column="25" bodyfile="C:/Users/manoe/OneDrive/TI/EmbarcaTech/Segunda Fase/01_Unid.01_Microcontrolador/Atividades/Cap_04/Atividade_04/Atividade_04/src/Atividade_04.c" bodystart="87" bodyend="-1"/>
      </memberdef>
      <memberdef kind="variable" id="_atividade__04_8c_1a75a34bdf1ffa12044ddb09c31d963edd" prot="public" static="yes" mutable="no">
        <type>volatile int</type>
        <definition>volatile int countdown_sec</definition>
        <argsstring></argsstring>
        <name>countdown_sec</name>
        <initializer>= <ref refid="_atividade__04_8c_1ad12a564ad91765abf118b1a1c935a79b" kindref="member">RED_TIME_SEC</ref></initializer>
        <briefdescription>
<para>Contador de segundos restante no estado atual. </para>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/Users/manoe/OneDrive/TI/EmbarcaTech/Segunda Fase/01_Unid.01_Microcontrolador/Atividades/Cap_04/Atividade_04/Atividade_04/src/Atividade_04.c" line="90" column="25" bodyfile="C:/Users/manoe/OneDrive/TI/EmbarcaTech/Segunda Fase/01_Unid.01_Microcontrolador/Atividades/Cap_04/Atividade_04/Atividade_04/src/Atividade_04.c" bodystart="90" bodyend="-1"/>
      </memberdef>
      <memberdef kind="variable" id="_atividade__04_8c_1a87b3873fb6337c08e0a14cbafdbdadb3" prot="public" static="yes" mutable="no">
        <type>volatile int</type>
        <definition>volatile int ped_request_dir</definition>
        <argsstring></argsstring>
        <name>ped_request_dir</name>
        <initializer>= 0</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<para>Travessia agendada: 1 ou 2 </para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/Users/manoe/OneDrive/TI/EmbarcaTech/Segunda Fase/01_Unid.01_Microcontrolador/Atividades/Cap_04/Atividade_04/Atividade_04/src/Atividade_04.c" line="92" column="23" bodyfile="C:/Users/manoe/OneDrive/TI/EmbarcaTech/Segunda Fase/01_Unid.01_Microcontrolador/Atividades/Cap_04/Atividade_04/Atividade_04/src/Atividade_04.c" bodystart="92" bodyend="-1"/>
      </memberdef>
      <memberdef kind="variable" id="_atividade__04_8c_1a6ec7d5c95351217346ebd56922950736" prot="public" static="yes" mutable="no">
        <type>volatile int</type>
        <definition>volatile int red_from_ped_dir</definition>
        <argsstring></argsstring>
        <name>red_from_ped_dir</name>
        <initializer>= 0</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<para>Vermelho iniciado por pedestre </para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/Users/manoe/OneDrive/TI/EmbarcaTech/Segunda Fase/01_Unid.01_Microcontrolador/Atividades/Cap_04/Atividade_04/Atividade_04/src/Atividade_04.c" line="93" column="23" bodyfile="C:/Users/manoe/OneDrive/TI/EmbarcaTech/Segunda Fase/01_Unid.01_Microcontrolador/Atividades/Cap_04/Atividade_04/Atividade_04/src/Atividade_04.c" bodystart="93" bodyend="-1"/>
      </memberdef>
      <memberdef kind="variable" id="_atividade__04_8c_1ac749231214a0a374d533dd9e2e54a12a" prot="public" static="yes" mutable="no">
        <type>struct repeating_timer</type>
        <definition>struct repeating_timer timer_1s</definition>
        <argsstring></argsstring>
        <name>timer_1s</name>
        <briefdescription>
<para>Timer periódico de 1 Hz. </para>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/Users/manoe/OneDrive/TI/EmbarcaTech/Segunda Fase/01_Unid.01_Microcontrolador/Atividades/Cap_04/Atividade_04/Atividade_04/src/Atividade_04.c" line="96" column="29" bodyfile="C:/Users/manoe/OneDrive/TI/EmbarcaTech/Segunda Fase/01_Unid.01_Microcontrolador/Atividades/Cap_04/Atividade_04/Atividade_04/src/Atividade_04.c" bodystart="96" bodyend="-1"/>
      </memberdef>
      <memberdef kind="variable" id="_atividade__04_8c_1ac8913b180f61e54dbd5836fcad825fa4" prot="public" static="yes" mutable="no">
        <type>uint8_t</type>
        <definition>uint8_t oled_buf[ssd1306_buffer_length]</definition>
        <argsstring>[ssd1306_buffer_length]</argsstring>
        <name>oled_buf</name>
        <briefdescription>
<para>Buffer interno para renderização no OLED. </para>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/Users/manoe/OneDrive/TI/EmbarcaTech/Segunda Fase/01_Unid.01_Microcontrolador/Atividades/Cap_04/Atividade_04/Atividade_04/src/Atividade_04.c" line="99" column="26" bodyfile="C:/Users/manoe/OneDrive/TI/EmbarcaTech/Segunda Fase/01_Unid.01_Microcontrolador/Atividades/Cap_04/Atividade_04/Atividade_04/src/Atividade_04.c" bodystart="99" bodyend="-1"/>
      </memberdef>
      <memberdef kind="variable" id="_atividade__04_8c_1a8a2d3a68931f9ca89d4fe36361492a6a" prot="public" static="yes" mutable="no">
        <type>struct <ref refid="structrender__area" kindref="compound">render_area</ref></type>
        <definition>struct render_area full_area</definition>
        <argsstring></argsstring>
        <name>full_area</name>
        <briefdescription>
<para>Área de renderização full-screen do OLED. </para>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/Users/manoe/OneDrive/TI/EmbarcaTech/Segunda Fase/01_Unid.01_Microcontrolador/Atividades/Cap_04/Atividade_04/Atividade_04/src/Atividade_04.c" line="102" column="25" bodyfile="C:/Users/manoe/OneDrive/TI/EmbarcaTech/Segunda Fase/01_Unid.01_Microcontrolador/Atividades/Cap_04/Atividade_04/Atividade_04/src/Atividade_04.c" bodystart="102" bodyend="-1"/>
      </memberdef>
    </sectiondef>
    <sectiondef kind="func">
      <memberdef kind="function" id="_atividade__04_8c_1ae645657433565bf733f5b31937955123" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>static void hw_init</definition>
        <argsstring>(void)</argsstring>
        <name>hw_init</name>
        <param>
          <type>void</type>
        </param>
        <briefdescription>
<para>Configura hardware: GPIOs, I2C e inicialização do OLED. </para>
        </briefdescription>
        <detaileddescription>
<para>Inicializa GPIOs de LEDs, buzzers, botões e I2C para o OLED.</para>
<para>Configura direções, pull-ups, IRQs de botão e chama oled_init(). </para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/Users/manoe/OneDrive/TI/EmbarcaTech/Segunda Fase/01_Unid.01_Microcontrolador/Atividades/Cap_04/Atividade_04/Atividade_04/src/Atividade_04.c" line="147" column="13" bodyfile="C:/Users/manoe/OneDrive/TI/EmbarcaTech/Segunda Fase/01_Unid.01_Microcontrolador/Atividades/Cap_04/Atividade_04/Atividade_04/src/Atividade_04.c" bodystart="147" bodyend="180" declfile="C:/Users/manoe/OneDrive/TI/EmbarcaTech/Segunda Fase/01_Unid.01_Microcontrolador/Atividades/Cap_04/Atividade_04/Atividade_04/src/Atividade_04.c" declline="106" declcolumn="13"/>
      </memberdef>
      <memberdef kind="function" id="_atividade__04_8c_1af5b30eb433745769b0531884a446a25b" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>static void oled_init</definition>
        <argsstring>(void)</argsstring>
        <name>oled_init</name>
        <param>
          <type>void</type>
        </param>
        <briefdescription>
<para>Inicializa o display OLED (comandos, buffer e mensagem) </para>
        </briefdescription>
        <detaileddescription>
<para>Envia comandos de inicialização ao SSD1306 e exibe mensagem inicial. </para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/Users/manoe/OneDrive/TI/EmbarcaTech/Segunda Fase/01_Unid.01_Microcontrolador/Atividades/Cap_04/Atividade_04/Atividade_04/src/Atividade_04.c" line="185" column="13" bodyfile="C:/Users/manoe/OneDrive/TI/EmbarcaTech/Segunda Fase/01_Unid.01_Microcontrolador/Atividades/Cap_04/Atividade_04/Atividade_04/src/Atividade_04.c" bodystart="185" bodyend="199" declfile="C:/Users/manoe/OneDrive/TI/EmbarcaTech/Segunda Fase/01_Unid.01_Microcontrolador/Atividades/Cap_04/Atividade_04/Atividade_04/src/Atividade_04.c" declline="109" declcolumn="13"/>
      </memberdef>
      <memberdef kind="function" id="_atividade__04_8c_1a4608e1fb635b3114ed8b3ac7fe7d09f1" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>static void oled_clear</definition>
        <argsstring>(void)</argsstring>
        <name>oled_clear</name>
        <param>
          <type>void</type>
        </param>
        <briefdescription>
<para>Limpa completamente o display OLED. </para>
        </briefdescription>
        <detaileddescription>
<para>Limpa o buffer e atualiza o display OLED. </para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/Users/manoe/OneDrive/TI/EmbarcaTech/Segunda Fase/01_Unid.01_Microcontrolador/Atividades/Cap_04/Atividade_04/Atividade_04/src/Atividade_04.c" line="204" column="13" bodyfile="C:/Users/manoe/OneDrive/TI/EmbarcaTech/Segunda Fase/01_Unid.01_Microcontrolador/Atividades/Cap_04/Atividade_04/Atividade_04/src/Atividade_04.c" bodystart="204" bodyend="207" declfile="C:/Users/manoe/OneDrive/TI/EmbarcaTech/Segunda Fase/01_Unid.01_Microcontrolador/Atividades/Cap_04/Atividade_04/Atividade_04/src/Atividade_04.c" declline="112" declcolumn="13"/>
      </memberdef>
      <memberdef kind="function" id="_atividade__04_8c_1a69f226189729aba429635cce5266d88b" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>static void oled_show_state</definition>
        <argsstring>(state_t st)</argsstring>
        <name>oled_show_state</name>
        <param>
          <type><ref refid="_atividade__04_8c_1aa0aafed44fec19806d8f9ad834be1248" kindref="member">state_t</ref></type>
          <declname>st</declname>
        </param>
        <briefdescription>
<para>Exibe texto do estado atual no OLED. </para>
        </briefdescription>
        <detaileddescription>
<para>Exibe mensagem de estado no OLED (VERMELHO, VERDE ou AMARELO)</para>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>st</parametername>
</parameternamelist>
<parameterdescription>
<para>Estado do semáforo (Vermelho, Verde ou Amarelo)</para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>st</parametername>
</parameternamelist>
<parameterdescription>
<para>Estado do semáforo </para>
</parameterdescription>
</parameteritem>
</parameterlist>
</para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/Users/manoe/OneDrive/TI/EmbarcaTech/Segunda Fase/01_Unid.01_Microcontrolador/Atividades/Cap_04/Atividade_04/Atividade_04/src/Atividade_04.c" line="213" column="13" bodyfile="C:/Users/manoe/OneDrive/TI/EmbarcaTech/Segunda Fase/01_Unid.01_Microcontrolador/Atividades/Cap_04/Atividade_04/Atividade_04/src/Atividade_04.c" bodystart="213" bodyend="227" declfile="C:/Users/manoe/OneDrive/TI/EmbarcaTech/Segunda Fase/01_Unid.01_Microcontrolador/Atividades/Cap_04/Atividade_04/Atividade_04/src/Atividade_04.c" declline="117" declcolumn="13"/>
      </memberdef>
      <memberdef kind="function" id="_atividade__04_8c_1af7b625341315902b3b7872013e453699" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>static void oled_show_countdown</definition>
        <argsstring>(int n)</argsstring>
        <name>oled_show_countdown</name>
        <param>
          <type>int</type>
          <declname>n</declname>
        </param>
        <briefdescription>
<para>Exibe um número centralizado no OLED. </para>
        </briefdescription>
        <detaileddescription>
<para>Exibe um valor centralizado no display para contagem regressiva.</para>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>n</parametername>
</parameternamelist>
<parameterdescription>
<para>Valor a ser exibido (contagem regressiva)</para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>n</parametername>
</parameternamelist>
<parameterdescription>
<para>Segundo restante a ser exibido </para>
</parameterdescription>
</parameteritem>
</parameterlist>
</para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/Users/manoe/OneDrive/TI/EmbarcaTech/Segunda Fase/01_Unid.01_Microcontrolador/Atividades/Cap_04/Atividade_04/Atividade_04/src/Atividade_04.c" line="233" column="13" bodyfile="C:/Users/manoe/OneDrive/TI/EmbarcaTech/Segunda Fase/01_Unid.01_Microcontrolador/Atividades/Cap_04/Atividade_04/Atividade_04/src/Atividade_04.c" bodystart="233" bodyend="239" declfile="C:/Users/manoe/OneDrive/TI/EmbarcaTech/Segunda Fase/01_Unid.01_Microcontrolador/Atividades/Cap_04/Atividade_04/Atividade_04/src/Atividade_04.c" declline="122" declcolumn="13"/>
      </memberdef>
      <memberdef kind="function" id="_atividade__04_8c_1a98606800b141cffb9060e4cbf69d8bf4" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>static void set_led_color</definition>
        <argsstring>(state_t st)</argsstring>
        <name>set_led_color</name>
        <param>
          <type><ref refid="_atividade__04_8c_1aa0aafed44fec19806d8f9ad834be1248" kindref="member">state_t</ref></type>
          <declname>st</declname>
        </param>
        <briefdescription>
<para>Atualiza LEDs conforme estado. </para>
        </briefdescription>
        <detaileddescription>
<para>Atualiza estado dos LEDs RGB conforme estado do semáforo.</para>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>st</parametername>
</parameternamelist>
<parameterdescription>
<para>Estado do semáforo para definir cor</para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>st</parametername>
</parameternamelist>
<parameterdescription>
<para>Estado atual (vermelho, verde ou amarelo) </para>
</parameterdescription>
</parameteritem>
</parameterlist>
</para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/Users/manoe/OneDrive/TI/EmbarcaTech/Segunda Fase/01_Unid.01_Microcontrolador/Atividades/Cap_04/Atividade_04/Atividade_04/src/Atividade_04.c" line="245" column="13" bodyfile="C:/Users/manoe/OneDrive/TI/EmbarcaTech/Segunda Fase/01_Unid.01_Microcontrolador/Atividades/Cap_04/Atividade_04/Atividade_04/src/Atividade_04.c" bodystart="245" bodyend="249" declfile="C:/Users/manoe/OneDrive/TI/EmbarcaTech/Segunda Fase/01_Unid.01_Microcontrolador/Atividades/Cap_04/Atividade_04/Atividade_04/src/Atividade_04.c" declline="127" declcolumn="13"/>
      </memberdef>
      <memberdef kind="function" id="_atividade__04_8c_1acea4dbf08c2da3d3527b46a8a1c249ba" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>bool</type>
        <definition>static bool timer_cb</definition>
        <argsstring>(struct repeating_timer *t)</argsstring>
        <name>timer_cb</name>
        <param>
          <type>struct repeating_timer *</type>
          <declname>t</declname>
        </param>
        <briefdescription>
<para>Callback chamado a cada segundo pelo timer. </para>
        </briefdescription>
        <detaileddescription>
<para>Callback de 1 Hz responsável por decremento e transições.</para>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>t</parametername>
</parameternamelist>
<parameterdescription>
<para>Ponteiro para struct de timer (não usado) </para>
</parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para>true para manter o timer ativo</para>
</simplesect>
<parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>t</parametername>
</parameternamelist>
<parameterdescription>
<para>Ponteiro para a struct do timer (unused) </para>
</parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para>true para manter o timer ativo </para>
</simplesect>
</para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/Users/manoe/OneDrive/TI/EmbarcaTech/Segunda Fase/01_Unid.01_Microcontrolador/Atividades/Cap_04/Atividade_04/Atividade_04/src/Atividade_04.c" line="256" column="13" bodyfile="C:/Users/manoe/OneDrive/TI/EmbarcaTech/Segunda Fase/01_Unid.01_Microcontrolador/Atividades/Cap_04/Atividade_04/Atividade_04/src/Atividade_04.c" bodystart="256" bodyend="309" declfile="C:/Users/manoe/OneDrive/TI/EmbarcaTech/Segunda Fase/01_Unid.01_Microcontrolador/Atividades/Cap_04/Atividade_04/Atividade_04/src/Atividade_04.c" declline="133" declcolumn="13"/>
      </memberdef>
      <memberdef kind="function" id="_atividade__04_8c_1a15251d5b761cd87e891ebc4e934c55b6" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>static void button_irq</definition>
        <argsstring>(uint gpio, uint32_t events)</argsstring>
        <name>button_irq</name>
        <param>
          <type>uint</type>
          <declname>gpio</declname>
        </param>
        <param>
          <type>uint32_t</type>
          <declname>events</declname>
        </param>
        <briefdescription>
<para>Tratador de interrupção dos botões de pedestre. </para>
        </briefdescription>
        <detaileddescription>
<para>Handler de interrupção para botões de travessia.</para>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>gpio</parametername>
</parameternamelist>
<parameterdescription>
<para>Pino que gerou a interrupção </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>events</parametername>
</parameternamelist>
<parameterdescription>
<para>Tipo de evento (não usado)</para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>gpio</parametername>
</parameternamelist>
<parameterdescription>
<para>Pino que gerou a IRQ </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>events</parametername>
</parameternamelist>
<parameterdescription>
<para>Tipo de evento (unused) </para>
</parameterdescription>
</parameteritem>
</parameterlist>
</para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/Users/manoe/OneDrive/TI/EmbarcaTech/Segunda Fase/01_Unid.01_Microcontrolador/Atividades/Cap_04/Atividade_04/Atividade_04/src/Atividade_04.c" line="316" column="13" bodyfile="C:/Users/manoe/OneDrive/TI/EmbarcaTech/Segunda Fase/01_Unid.01_Microcontrolador/Atividades/Cap_04/Atividade_04/Atividade_04/src/Atividade_04.c" bodystart="316" bodyend="332" declfile="C:/Users/manoe/OneDrive/TI/EmbarcaTech/Segunda Fase/01_Unid.01_Microcontrolador/Atividades/Cap_04/Atividade_04/Atividade_04/src/Atividade_04.c" declline="139" declcolumn="13"/>
      </memberdef>
      <memberdef kind="function" id="_atividade__04_8c_1a840291bc02cba5474a4cb46a9b9566fe" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int</type>
        <definition>int main</definition>
        <argsstring>(void)</argsstring>
        <name>main</name>
        <param>
          <type>void</type>
        </param>
        <briefdescription>
<para>Função principal: inicializa hardware e entra em loop de espera. </para>
        </briefdescription>
        <detaileddescription>
<para><orderedlist>
<listitem><para>Chama hw_init() para configurar GPIOs, I2C e display OLED.</para>
</listitem><listitem><para>Define cor inicial do semáforo para vermelho e exibe no OLED.</para>
</listitem><listitem><para>Adiciona timer periódico de 1 Hz para gerenciar transições de estado e contagem regressiva.</para>
</listitem><listitem><para>Entra em loop infinito com tight_loop_contents(), permitindo que a CPU aguarde de forma eficiente por interrupções de botões e callbacks. <simplesect kind="return"><para>Esta função não retorna. </para>
</simplesect>
</para>
</listitem></orderedlist>
</para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/Users/manoe/OneDrive/TI/EmbarcaTech/Segunda Fase/01_Unid.01_Microcontrolador/Atividades/Cap_04/Atividade_04/Atividade_04/src/Atividade_04.c" line="345" column="5" bodyfile="C:/Users/manoe/OneDrive/TI/EmbarcaTech/Segunda Fase/01_Unid.01_Microcontrolador/Atividades/Cap_04/Atividade_04/Atividade_04/src/Atividade_04.c" bodystart="345" bodyend="368"/>
      </memberdef>
    </sectiondef>
    <briefdescription>
<para>Simulação de semáforo de trânsito com acessibilidade para pedestres. </para>
    </briefdescription>
    <detaileddescription>
<para>Implementa ciclo semafórico fixo (Vermelho → Verde → Amarelo) e lógica de travessia para pedestres. Ao acionar botão em vermelho, reinicia-se o temporizador para 10 s completos e exibe-se contagem regressiva nos últimos 5 s no display OLED. Botões em verde/amarelo agendam countdown no próximo vermelho. Em vermelho, buzzer em GP10 e GP21 bipam a 1 Hz. Usei estilo Doxygen e comentários completos. Para fins didáticos.</para>
<para>• Ciclo semafórico fixo: Vermelho 10 s → Verde 10 s → Amarelo 3 s ↺ <linebreak/>
 Requisitos de pedestre: <linebreak/>
<itemizedlist>
<listitem><para>Em VERMELHO: qualquer botão reinicia contagem para 10 s, exibe <linebreak/>
 imediatamente &quot;Sinal: VERMELHO&quot; e, nos últimos 5 s, mostra <linebreak/>
 contagem regressiva no OLED. <linebreak/>
</para>
</listitem><listitem><para>Em VERDE ou AMARELO: botão A/B agenda countdown no próximo VERMELHO; Verde encurtado se pedido em VERDE.</para>
</listitem><listitem><para>Travessia bidirecional: um botão em cada lado da avenida (BUTTON_PIN1 e BUTTON_PIN2). Quando ambos são acionados simultaneamente, define-se prioridade para BUTTON_PIN1 (lado 1) sobre BUTTON_PIN2 (lado 2). <linebreak/>
 • Buzzer soa 1 Hz SEMPRE em VERMELHO. - Acessibilidade <linebreak/>
 • Botão A (GPIO 5) ou Botão B (6). • Lógica baseada em IRQ GPIO + temporizador 1 Hz. Sem polling intenso.</para>
</listitem></itemizedlist>
</para>
<para>Hardware:<itemizedlist>
<listitem><para>LED RGB: GP11 (Verde), GP13 (Vermelho) (GP12 não usado)</para>
</listitem><listitem><para>Buzzer: GP10, GP21</para>
</listitem><listitem><para>Botões: GP5, GP6 (INPUT_PULLUP)</para>
</listitem><listitem><para>OLED: I2C1 SDA GP14, SCL GP15</para>
</listitem></itemizedlist>
</para>
<para><simplesect kind="author"><para>Manoel Furtado </para>
</simplesect>
<simplesect kind="date"><para>15 mai 2025 </para>
</simplesect>
<simplesect kind="copyright"><para>2025 Manoel Furtado (MIT License) (veja LICENSE.md) </para>
</simplesect>
</para>
    </detaileddescription>
    <programlisting>
<codeline lineno="1"><highlight class="normal"></highlight></codeline>
<codeline lineno="35"><highlight class="normal"></highlight></codeline>
<codeline lineno="36"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;stdio.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="37"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;string.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="38"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;pico/stdlib.h&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="39"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;hardware/gpio.h&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="40"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;hardware/timer.h&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="41"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;hardware/i2c.h&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="42"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;ssd1306_i2c.h&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="43"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;ssd1306.h&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="44"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;ssd1306_font.h&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="45"><highlight class="normal"></highlight></codeline>
<codeline lineno="46"><highlight class="normal"></highlight><highlight class="comment">/*─────────────────────────<sp/>Constantes<sp/>de<sp/>tempo<sp/>(segundos)<sp/>─────────────────────────*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="48"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>RED_TIME_SEC<sp/><sp/><sp/><sp/><sp/><sp/><sp/>10</highlight><highlight class="preprocessor"></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="50"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>GREEN_TIME_SEC<sp/><sp/><sp/><sp/><sp/>10</highlight><highlight class="preprocessor"></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="52"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>YELLOW_TIME_SEC<sp/><sp/><sp/><sp/><sp/>3</highlight><highlight class="preprocessor"></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="54"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>COUNTDOWN_START<sp/><sp/><sp/><sp/><sp/>5</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="55"><highlight class="normal"></highlight></codeline>
<codeline lineno="56"><highlight class="normal"></highlight><highlight class="comment">/*────────────────────────────<sp/>GPIO<sp/>Mapping<sp/>────────────────────────────*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="58"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>LED_RED_PIN<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>13</highlight><highlight class="preprocessor"></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="60"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>LED_GREEN_PIN<sp/><sp/><sp/><sp/><sp/><sp/>11</highlight><highlight class="preprocessor"></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="62"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>LED_BLUE_PIN<sp/><sp/><sp/><sp/><sp/><sp/><sp/>12</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="63"><highlight class="normal"></highlight></codeline>
<codeline lineno="65"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>BUZZER_PIN1<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>10</highlight><highlight class="preprocessor"></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="67"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>BUZZER_PIN2<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>21</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="68"><highlight class="normal"></highlight></codeline>
<codeline lineno="70"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>BUTTON_PIN1<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>5</highlight><highlight class="preprocessor"></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="72"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>BUTTON_PIN2<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>6</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="73"><highlight class="normal"></highlight></codeline>
<codeline lineno="74"><highlight class="normal"></highlight><highlight class="comment">//<sp/>I²C0<sp/>para<sp/>OLED<sp/>SSD1306</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="75"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>I2C_SDA_PIN<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>14<sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>GP14:<sp/>SDA0<sp/>(I2C0)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="76"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>I2C_SCL_PIN<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>15<sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>GP15:<sp/>SCL0<sp/>(I2C0)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="77"><highlight class="normal"></highlight></codeline>
<codeline lineno="78"><highlight class="normal"></highlight><highlight class="comment">/*────────────────────────────<sp/>Tipos<sp/>e<sp/>variáveis<sp/>───────────────────────────*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="80"><highlight class="normal"></highlight><highlight class="keyword">typedef</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">enum</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="81"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="_atividade__04_8c_1aa0aafed44fec19806d8f9ad834be1248ad2aaf0c286ae52532c96f716b3410aed" kindref="member">ST_RED</ref><sp/>=<sp/>0,<sp/><sp/><sp/></highlight></codeline>
<codeline lineno="82"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="_atividade__04_8c_1aa0aafed44fec19806d8f9ad834be1248a3680d3e43be15ef8b428fe0a64956b90" kindref="member">ST_GREEN</ref>,<sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="83"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="_atividade__04_8c_1aa0aafed44fec19806d8f9ad834be1248a7b5984aa066eb4676d7f8747429d5f3b" kindref="member">ST_YELLOW</ref><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="84"><highlight class="normal">}<sp/><ref refid="_atividade__04_8c_1aa0aafed44fec19806d8f9ad834be1248" kindref="member">state_t</ref>;</highlight></codeline>
<codeline lineno="85"><highlight class="normal"></highlight></codeline>
<codeline lineno="87"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">volatile</highlight><highlight class="normal"><sp/><ref refid="_atividade__04_8c_1aa0aafed44fec19806d8f9ad834be1248" kindref="member">state_t</ref><sp/>current_state<sp/>=<sp/><ref refid="_atividade__04_8c_1aa0aafed44fec19806d8f9ad834be1248ad2aaf0c286ae52532c96f716b3410aed" kindref="member">ST_RED</ref>;</highlight></codeline>
<codeline lineno="88"><highlight class="normal"></highlight></codeline>
<codeline lineno="90"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">volatile</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><sp/><sp/><sp/><sp/>countdown_sec<sp/>=<sp/><ref refid="_atividade__04_8c_1ad12a564ad91765abf118b1a1c935a79b" kindref="member">RED_TIME_SEC</ref>;</highlight></codeline>
<codeline lineno="91"><highlight class="normal"></highlight></codeline>
<codeline lineno="92"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">volatile</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><sp/><sp/>ped_request_dir<sp/>=<sp/>0;<sp/><sp/></highlight></codeline>
<codeline lineno="93"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">volatile</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><sp/><sp/>red_from_ped_dir=<sp/>0;<sp/><sp/></highlight></codeline>
<codeline lineno="94"><highlight class="normal"></highlight></codeline>
<codeline lineno="96"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">struct<sp/></highlight><highlight class="normal">repeating_timer<sp/>timer_1s;</highlight></codeline>
<codeline lineno="97"><highlight class="normal"></highlight></codeline>
<codeline lineno="99"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/>uint8_t<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>oled_buf[ssd1306_buffer_length];</highlight></codeline>
<codeline lineno="100"><highlight class="normal"></highlight></codeline>
<codeline lineno="102"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">struct<sp/></highlight><highlight class="normal"><ref refid="structrender__area" kindref="compound">render_area</ref><sp/>full_area;</highlight></codeline>
<codeline lineno="103"><highlight class="normal"></highlight></codeline>
<codeline lineno="104"><highlight class="normal"></highlight><highlight class="comment">/*──────────────────────────<sp/>Protótipos<sp/>de<sp/>funções<sp/>──────────────────────────*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="106"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>hw_init(</highlight><highlight class="keywordtype">void</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="107"><highlight class="normal"></highlight></codeline>
<codeline lineno="109"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>oled_init(</highlight><highlight class="keywordtype">void</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="110"><highlight class="normal"></highlight></codeline>
<codeline lineno="112"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>oled_clear(</highlight><highlight class="keywordtype">void</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="113"><highlight class="normal"></highlight></codeline>
<codeline lineno="117"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>oled_show_state(<ref refid="_atividade__04_8c_1aa0aafed44fec19806d8f9ad834be1248" kindref="member">state_t</ref><sp/>st);</highlight></codeline>
<codeline lineno="118"><highlight class="normal"></highlight></codeline>
<codeline lineno="122"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>oled_show_countdown(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>n);</highlight></codeline>
<codeline lineno="123"><highlight class="normal"></highlight></codeline>
<codeline lineno="127"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>set_led_color(<ref refid="_atividade__04_8c_1aa0aafed44fec19806d8f9ad834be1248" kindref="member">state_t</ref><sp/>st);</highlight></codeline>
<codeline lineno="128"><highlight class="normal"></highlight></codeline>
<codeline lineno="133"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>timer_cb(</highlight><highlight class="keyword">struct</highlight><highlight class="normal"><sp/>repeating_timer<sp/>*t);</highlight></codeline>
<codeline lineno="134"><highlight class="normal"></highlight></codeline>
<codeline lineno="139"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>button_irq(uint<sp/>gpio,<sp/>uint32_t<sp/>events);</highlight></codeline>
<codeline lineno="140"><highlight class="normal"></highlight></codeline>
<codeline lineno="141"><highlight class="normal"></highlight><highlight class="comment">/*──────────────────────────<sp/>Implementação<sp/>das<sp/>funções<sp/>───────────────────────*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="142"><highlight class="normal"></highlight></codeline>
<codeline lineno="147"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>hw_init(</highlight><highlight class="keywordtype">void</highlight><highlight class="normal">)<sp/>{</highlight></codeline>
<codeline lineno="148"><highlight class="normal"><sp/><sp/><sp/><sp/>stdio_init_all();</highlight></codeline>
<codeline lineno="149"><highlight class="normal"></highlight></codeline>
<codeline lineno="150"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Configura<sp/>LEDs<sp/>como<sp/>saída<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="151"><highlight class="normal"><sp/><sp/><sp/><sp/>gpio_init(<ref refid="_atividade__04_8c_1ab9824ab080c30006c1baaa0dd7e863c5" kindref="member">LED_RED_PIN</ref>);<sp/><sp/><sp/>gpio_set_dir(<ref refid="_atividade__04_8c_1ab9824ab080c30006c1baaa0dd7e863c5" kindref="member">LED_RED_PIN</ref>,<sp/><sp/><sp/>GPIO_OUT);</highlight></codeline>
<codeline lineno="152"><highlight class="normal"><sp/><sp/><sp/><sp/>gpio_init(<ref refid="_atividade__04_8c_1a0539be032702009fb24beec89c6fa0c0" kindref="member">LED_GREEN_PIN</ref>);<sp/>gpio_set_dir(<ref refid="_atividade__04_8c_1a0539be032702009fb24beec89c6fa0c0" kindref="member">LED_GREEN_PIN</ref>,<sp/>GPIO_OUT);</highlight></codeline>
<codeline lineno="153"><highlight class="normal"><sp/><sp/><sp/><sp/>gpio_init(<ref refid="_atividade__04_8c_1a5aec9d3b503fb1a30a21b16c7be86cff" kindref="member">LED_BLUE_PIN</ref>);<sp/><sp/>gpio_set_dir(<ref refid="_atividade__04_8c_1a5aec9d3b503fb1a30a21b16c7be86cff" kindref="member">LED_BLUE_PIN</ref>,<sp/><sp/>GPIO_OUT);</highlight></codeline>
<codeline lineno="154"><highlight class="normal"></highlight></codeline>
<codeline lineno="155"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Configura<sp/>buzzers<sp/>como<sp/>saída,<sp/>estado<sp/>inicial<sp/>baixo<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="156"><highlight class="normal"><sp/><sp/><sp/><sp/>gpio_init(<ref refid="_atividade__04_8c_1acbc26198121732a3c0a6888f8f4cb028" kindref="member">BUZZER_PIN1</ref>);<sp/><sp/><sp/>gpio_set_dir(<ref refid="_atividade__04_8c_1acbc26198121732a3c0a6888f8f4cb028" kindref="member">BUZZER_PIN1</ref>,<sp/><sp/>GPIO_OUT);</highlight></codeline>
<codeline lineno="157"><highlight class="normal"><sp/><sp/><sp/><sp/>gpio_init(<ref refid="_atividade__04_8c_1a6a9a564ed2b8f42d387f38dac7ed1b62" kindref="member">BUZZER_PIN2</ref>);<sp/><sp/><sp/>gpio_set_dir(<ref refid="_atividade__04_8c_1a6a9a564ed2b8f42d387f38dac7ed1b62" kindref="member">BUZZER_PIN2</ref>,<sp/><sp/>GPIO_OUT);</highlight></codeline>
<codeline lineno="158"><highlight class="normal"><sp/><sp/><sp/><sp/>gpio_put(<ref refid="_atividade__04_8c_1acbc26198121732a3c0a6888f8f4cb028" kindref="member">BUZZER_PIN1</ref>,<sp/>0);</highlight></codeline>
<codeline lineno="159"><highlight class="normal"><sp/><sp/><sp/><sp/>gpio_put(<ref refid="_atividade__04_8c_1a6a9a564ed2b8f42d387f38dac7ed1b62" kindref="member">BUZZER_PIN2</ref>,<sp/>0);</highlight></codeline>
<codeline lineno="160"><highlight class="normal"></highlight></codeline>
<codeline lineno="161"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Configura<sp/>botões<sp/>como<sp/>entrada<sp/>com<sp/>pull-up<sp/>e<sp/>IRQ<sp/>em<sp/>borda<sp/>de<sp/>descida<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="162"><highlight class="normal"><sp/><sp/><sp/><sp/>gpio_init(<ref refid="_atividade__04_8c_1aad905e2ee036ff31a5cc49b248361420" kindref="member">BUTTON_PIN1</ref>);<sp/><sp/><sp/>gpio_set_dir(<ref refid="_atividade__04_8c_1aad905e2ee036ff31a5cc49b248361420" kindref="member">BUTTON_PIN1</ref>,<sp/>GPIO_IN);</highlight></codeline>
<codeline lineno="163"><highlight class="normal"><sp/><sp/><sp/><sp/>gpio_pull_up(<ref refid="_atividade__04_8c_1aad905e2ee036ff31a5cc49b248361420" kindref="member">BUTTON_PIN1</ref>);</highlight></codeline>
<codeline lineno="164"><highlight class="normal"><sp/><sp/><sp/><sp/>gpio_init(<ref refid="_atividade__04_8c_1ab7676ab9bef15c1956c8163558e3ac44" kindref="member">BUTTON_PIN2</ref>);<sp/><sp/><sp/>gpio_set_dir(<ref refid="_atividade__04_8c_1ab7676ab9bef15c1956c8163558e3ac44" kindref="member">BUTTON_PIN2</ref>,<sp/>GPIO_IN);</highlight></codeline>
<codeline lineno="165"><highlight class="normal"><sp/><sp/><sp/><sp/>gpio_pull_up(<ref refid="_atividade__04_8c_1ab7676ab9bef15c1956c8163558e3ac44" kindref="member">BUTTON_PIN2</ref>);</highlight></codeline>
<codeline lineno="166"><highlight class="normal"><sp/><sp/><sp/><sp/>gpio_set_irq_enabled_with_callback(<sp/></highlight></codeline>
<codeline lineno="167"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="_atividade__04_8c_1aad905e2ee036ff31a5cc49b248361420" kindref="member">BUTTON_PIN1</ref>,<sp/>GPIO_IRQ_EDGE_FALL,<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">,<sp/>&amp;button_irq);</highlight></codeline>
<codeline lineno="168"><highlight class="normal"><sp/><sp/><sp/><sp/>gpio_set_irq_enabled(</highlight></codeline>
<codeline lineno="169"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="_atividade__04_8c_1ab7676ab9bef15c1956c8163558e3ac44" kindref="member">BUTTON_PIN2</ref>,<sp/>GPIO_IRQ_EDGE_FALL,<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="170"><highlight class="normal"></highlight></codeline>
<codeline lineno="171"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Inicializa<sp/>interface<sp/>I2C1<sp/>para<sp/>o<sp/>OLED<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="172"><highlight class="normal"><sp/><sp/><sp/><sp/>i2c_init(i2c1,<sp/>ssd1306_i2c_clock<sp/>*<sp/>1000);</highlight></codeline>
<codeline lineno="173"><highlight class="normal"><sp/><sp/><sp/><sp/>gpio_set_function(I2C_SDA_PIN,<sp/>GPIO_FUNC_I2C);</highlight></codeline>
<codeline lineno="174"><highlight class="normal"><sp/><sp/><sp/><sp/>gpio_set_function(I2C_SCL_PIN,<sp/>GPIO_FUNC_I2C);</highlight></codeline>
<codeline lineno="175"><highlight class="normal"><sp/><sp/><sp/><sp/>gpio_pull_up(I2C_SDA_PIN);</highlight></codeline>
<codeline lineno="176"><highlight class="normal"><sp/><sp/><sp/><sp/>gpio_pull_up(I2C_SCL_PIN);</highlight></codeline>
<codeline lineno="177"><highlight class="normal"></highlight></codeline>
<codeline lineno="178"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Inicializa<sp/>o<sp/>display<sp/>OLED<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="179"><highlight class="normal"><sp/><sp/><sp/><sp/>oled_init();</highlight></codeline>
<codeline lineno="180"><highlight class="normal">}</highlight></codeline>
<codeline lineno="181"><highlight class="normal"></highlight></codeline>
<codeline lineno="185"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>oled_init(</highlight><highlight class="keywordtype">void</highlight><highlight class="normal">)<sp/>{</highlight></codeline>
<codeline lineno="186"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Limpa<sp/>buffer<sp/>e<sp/>define<sp/>área<sp/>full-screen<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="187"><highlight class="normal"><sp/><sp/><sp/><sp/>memset(oled_buf,<sp/>0,<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(oled_buf));</highlight></codeline>
<codeline lineno="188"><highlight class="normal"><sp/><sp/><sp/><sp/>full_area.start_column<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="189"><highlight class="normal"><sp/><sp/><sp/><sp/>full_area.end_column<sp/><sp/><sp/>=<sp/>ssd1306_width<sp/>-<sp/>1;</highlight></codeline>
<codeline lineno="190"><highlight class="normal"><sp/><sp/><sp/><sp/>full_area.start_page<sp/><sp/><sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="191"><highlight class="normal"><sp/><sp/><sp/><sp/>full_area.end_page<sp/><sp/><sp/><sp/><sp/>=<sp/>ssd1306_n_pages<sp/>-<sp/>1;</highlight></codeline>
<codeline lineno="192"><highlight class="normal"><sp/><sp/><sp/><sp/>calculate_render_area_buffer_length(&amp;full_area);</highlight></codeline>
<codeline lineno="193"><highlight class="normal"></highlight></codeline>
<codeline lineno="194"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Inicializa<sp/>o<sp/>controlador<sp/>SSD1306<sp/>e<sp/>exibe<sp/>texto<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="195"><highlight class="normal"><sp/><sp/><sp/><sp/>ssd1306_init();</highlight></codeline>
<codeline lineno="196"><highlight class="normal"><sp/><sp/><sp/><sp/>oled_clear();</highlight></codeline>
<codeline lineno="197"><highlight class="normal"><sp/><sp/><sp/><sp/>ssd1306_draw_string(oled_buf,<sp/>8,<sp/>24,<sp/></highlight><highlight class="stringliteral">&quot;Inicializando...&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="198"><highlight class="normal"><sp/><sp/><sp/><sp/>render_on_display(oled_buf,<sp/>&amp;full_area);</highlight></codeline>
<codeline lineno="199"><highlight class="normal">}</highlight></codeline>
<codeline lineno="200"><highlight class="normal"></highlight></codeline>
<codeline lineno="204"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>oled_clear(</highlight><highlight class="keywordtype">void</highlight><highlight class="normal">)<sp/>{</highlight></codeline>
<codeline lineno="205"><highlight class="normal"><sp/><sp/><sp/><sp/>memset(oled_buf,<sp/>0,<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(oled_buf));</highlight></codeline>
<codeline lineno="206"><highlight class="normal"><sp/><sp/><sp/><sp/>render_on_display(oled_buf,<sp/>&amp;full_area);</highlight></codeline>
<codeline lineno="207"><highlight class="normal">}</highlight></codeline>
<codeline lineno="208"><highlight class="normal"></highlight></codeline>
<codeline lineno="213"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>oled_show_state(<ref refid="_atividade__04_8c_1aa0aafed44fec19806d8f9ad834be1248" kindref="member">state_t</ref><sp/>st)<sp/>{</highlight></codeline>
<codeline lineno="214"><highlight class="normal"><sp/><sp/><sp/><sp/>oled_clear();</highlight></codeline>
<codeline lineno="215"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">switch</highlight><highlight class="normal"><sp/>(st)<sp/>{</highlight></codeline>
<codeline lineno="216"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="_atividade__04_8c_1aa0aafed44fec19806d8f9ad834be1248ad2aaf0c286ae52532c96f716b3410aed" kindref="member">ST_RED</ref>:</highlight></codeline>
<codeline lineno="217"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ssd1306_draw_string(oled_buf,<sp/>8,<sp/>24,<sp/></highlight><highlight class="stringliteral">&quot;Sinal:<sp/>VERMELHO&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="218"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="219"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="_atividade__04_8c_1aa0aafed44fec19806d8f9ad834be1248a3680d3e43be15ef8b428fe0a64956b90" kindref="member">ST_GREEN</ref>:</highlight></codeline>
<codeline lineno="220"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ssd1306_draw_string(oled_buf,<sp/>8,<sp/>24,<sp/></highlight><highlight class="stringliteral">&quot;Sinal:<sp/>VERDE&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="221"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="222"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="_atividade__04_8c_1aa0aafed44fec19806d8f9ad834be1248a7b5984aa066eb4676d7f8747429d5f3b" kindref="member">ST_YELLOW</ref>:</highlight></codeline>
<codeline lineno="223"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ssd1306_draw_string(oled_buf,<sp/>8,<sp/>24,<sp/></highlight><highlight class="stringliteral">&quot;Sinal:<sp/>AMARELO&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="224"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="225"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="226"><highlight class="normal"><sp/><sp/><sp/><sp/>render_on_display(oled_buf,<sp/>&amp;full_area);</highlight></codeline>
<codeline lineno="227"><highlight class="normal">}</highlight></codeline>
<codeline lineno="228"><highlight class="normal"></highlight></codeline>
<codeline lineno="233"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>oled_show_countdown(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>n)<sp/>{</highlight></codeline>
<codeline lineno="234"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>txt[8];</highlight></codeline>
<codeline lineno="235"><highlight class="normal"><sp/><sp/><sp/><sp/>snprintf(txt,<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(txt),<sp/></highlight><highlight class="stringliteral">&quot;%d&quot;</highlight><highlight class="normal">,<sp/>n);</highlight></codeline>
<codeline lineno="236"><highlight class="normal"><sp/><sp/><sp/><sp/>oled_clear();</highlight></codeline>
<codeline lineno="237"><highlight class="normal"><sp/><sp/><sp/><sp/>ssd1306_draw_string(oled_buf,<sp/>60,<sp/>24,<sp/>txt);</highlight></codeline>
<codeline lineno="238"><highlight class="normal"><sp/><sp/><sp/><sp/>render_on_display(oled_buf,<sp/>&amp;full_area);</highlight></codeline>
<codeline lineno="239"><highlight class="normal">}</highlight></codeline>
<codeline lineno="240"><highlight class="normal"></highlight></codeline>
<codeline lineno="245"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>set_led_color(<ref refid="_atividade__04_8c_1aa0aafed44fec19806d8f9ad834be1248" kindref="member">state_t</ref><sp/>st)<sp/>{</highlight></codeline>
<codeline lineno="246"><highlight class="normal"><sp/><sp/><sp/><sp/>gpio_put(<ref refid="_atividade__04_8c_1ab9824ab080c30006c1baaa0dd7e863c5" kindref="member">LED_RED_PIN</ref>,<sp/><sp/><sp/>(st<sp/>==<sp/><ref refid="_atividade__04_8c_1aa0aafed44fec19806d8f9ad834be1248ad2aaf0c286ae52532c96f716b3410aed" kindref="member">ST_RED</ref>)<sp/><sp/><sp/>||<sp/>(st<sp/>==<sp/><ref refid="_atividade__04_8c_1aa0aafed44fec19806d8f9ad834be1248a7b5984aa066eb4676d7f8747429d5f3b" kindref="member">ST_YELLOW</ref>));</highlight></codeline>
<codeline lineno="247"><highlight class="normal"><sp/><sp/><sp/><sp/>gpio_put(<ref refid="_atividade__04_8c_1a0539be032702009fb24beec89c6fa0c0" kindref="member">LED_GREEN_PIN</ref>,<sp/>(st<sp/>==<sp/><ref refid="_atividade__04_8c_1aa0aafed44fec19806d8f9ad834be1248a3680d3e43be15ef8b428fe0a64956b90" kindref="member">ST_GREEN</ref>)<sp/>||<sp/>(st<sp/>==<sp/><ref refid="_atividade__04_8c_1aa0aafed44fec19806d8f9ad834be1248a7b5984aa066eb4676d7f8747429d5f3b" kindref="member">ST_YELLOW</ref>));</highlight></codeline>
<codeline lineno="248"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>LED<sp/>azul<sp/>não<sp/>utilizado<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="249"><highlight class="normal">}</highlight></codeline>
<codeline lineno="250"><highlight class="normal"></highlight></codeline>
<codeline lineno="256"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>timer_cb(</highlight><highlight class="keyword">struct</highlight><highlight class="normal"><sp/>repeating_timer<sp/>*t)<sp/>{</highlight></codeline>
<codeline lineno="257"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>buzz_state<sp/>=<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="258"><highlight class="normal"></highlight></codeline>
<codeline lineno="259"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Buzzer<sp/>bip<sp/>1<sp/>Hz<sp/>enquanto<sp/>estiver<sp/>em<sp/>vermelho<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="260"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(current_state<sp/>==<sp/><ref refid="_atividade__04_8c_1aa0aafed44fec19806d8f9ad834be1248ad2aaf0c286ae52532c96f716b3410aed" kindref="member">ST_RED</ref>)<sp/>{</highlight></codeline>
<codeline lineno="261"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>buzz_state<sp/>=<sp/>!buzz_state;</highlight></codeline>
<codeline lineno="262"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>gpio_put(<ref refid="_atividade__04_8c_1acbc26198121732a3c0a6888f8f4cb028" kindref="member">BUZZER_PIN1</ref>,<sp/>buzz_state);</highlight></codeline>
<codeline lineno="263"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>gpio_put(<ref refid="_atividade__04_8c_1a6a9a564ed2b8f42d387f38dac7ed1b62" kindref="member">BUZZER_PIN2</ref>,<sp/>buzz_state);</highlight></codeline>
<codeline lineno="264"><highlight class="normal"><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="265"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>gpio_put(<ref refid="_atividade__04_8c_1acbc26198121732a3c0a6888f8f4cb028" kindref="member">BUZZER_PIN1</ref>,<sp/>0);</highlight></codeline>
<codeline lineno="266"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>gpio_put(<ref refid="_atividade__04_8c_1a6a9a564ed2b8f42d387f38dac7ed1b62" kindref="member">BUZZER_PIN2</ref>,<sp/>0);</highlight></codeline>
<codeline lineno="267"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="268"><highlight class="normal"></highlight></codeline>
<codeline lineno="269"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Decrementa<sp/>contador<sp/>de<sp/>segundos<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="270"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(countdown_sec<sp/>&gt;<sp/>0)<sp/>{</highlight></codeline>
<codeline lineno="271"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>countdown_sec--;</highlight></codeline>
<codeline lineno="272"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="273"><highlight class="normal"></highlight></codeline>
<codeline lineno="274"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Exibe<sp/>últimos<sp/>segundos<sp/>se<sp/>iniciado<sp/>por<sp/>pedestre<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="275"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(red_from_ped_dir<sp/>&amp;&amp;<sp/>current_state<sp/>==<sp/><ref refid="_atividade__04_8c_1aa0aafed44fec19806d8f9ad834be1248ad2aaf0c286ae52532c96f716b3410aed" kindref="member">ST_RED</ref><sp/>&amp;&amp;</highlight></codeline>
<codeline lineno="276"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>countdown_sec<sp/>&lt;=<sp/>COUNTDOWN_START<sp/>&amp;&amp;<sp/>countdown_sec<sp/>&gt;=<sp/>1)<sp/>{</highlight></codeline>
<codeline lineno="277"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>oled_show_countdown(countdown_sec);</highlight></codeline>
<codeline lineno="278"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="279"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Transição<sp/>de<sp/>estados<sp/>no<sp/>fim<sp/>da<sp/>contagem<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="280"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(countdown_sec<sp/>==<sp/>0)<sp/>{</highlight></codeline>
<codeline lineno="281"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">switch</highlight><highlight class="normal"><sp/>(current_state)<sp/>{</highlight></codeline>
<codeline lineno="282"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="_atividade__04_8c_1aa0aafed44fec19806d8f9ad834be1248ad2aaf0c286ae52532c96f716b3410aed" kindref="member">ST_RED</ref>:</highlight></codeline>
<codeline lineno="283"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>current_state<sp/><sp/><sp/>=<sp/><ref refid="_atividade__04_8c_1aa0aafed44fec19806d8f9ad834be1248a3680d3e43be15ef8b428fe0a64956b90" kindref="member">ST_GREEN</ref>;</highlight></codeline>
<codeline lineno="284"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>countdown_sec<sp/><sp/><sp/>=<sp/><ref refid="_atividade__04_8c_1a4807eaf5581317c4277f82c741f105ac" kindref="member">GREEN_TIME_SEC</ref>;</highlight></codeline>
<codeline lineno="285"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>red_from_ped_dir=<sp/>0;</highlight></codeline>
<codeline lineno="286"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ped_request_dir<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="287"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="288"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="_atividade__04_8c_1aa0aafed44fec19806d8f9ad834be1248a3680d3e43be15ef8b428fe0a64956b90" kindref="member">ST_GREEN</ref>:</highlight></codeline>
<codeline lineno="289"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>current_state<sp/>=<sp/><ref refid="_atividade__04_8c_1aa0aafed44fec19806d8f9ad834be1248a7b5984aa066eb4676d7f8747429d5f3b" kindref="member">ST_YELLOW</ref>;</highlight></codeline>
<codeline lineno="290"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>countdown_sec<sp/>=<sp/><ref refid="_atividade__04_8c_1aa878f52b8595a099574f3a1c12717b73" kindref="member">YELLOW_TIME_SEC</ref>;</highlight></codeline>
<codeline lineno="291"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="292"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="_atividade__04_8c_1aa0aafed44fec19806d8f9ad834be1248a7b5984aa066eb4676d7f8747429d5f3b" kindref="member">ST_YELLOW</ref>:</highlight></codeline>
<codeline lineno="293"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>current_state<sp/>=<sp/><ref refid="_atividade__04_8c_1aa0aafed44fec19806d8f9ad834be1248ad2aaf0c286ae52532c96f716b3410aed" kindref="member">ST_RED</ref>;</highlight></codeline>
<codeline lineno="294"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>countdown_sec<sp/>=<sp/><ref refid="_atividade__04_8c_1ad12a564ad91765abf118b1a1c935a79b" kindref="member">RED_TIME_SEC</ref>;</highlight></codeline>
<codeline lineno="295"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(ped_request_dir)<sp/>red_from_ped_dir<sp/>=<sp/>ped_request_dir;</highlight></codeline>
<codeline lineno="296"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ped_request_dir<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="297"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="298"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="299"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>set_led_color(current_state);</highlight></codeline>
<codeline lineno="300"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>oled_show_state(current_state);</highlight></codeline>
<codeline lineno="301"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="302"><highlight class="normal"></highlight></codeline>
<codeline lineno="303"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Se<sp/>pedido<sp/>em<sp/>VERDE,<sp/>encurta<sp/>para<sp/>próximo<sp/>ciclo<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="304"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(ped_request_dir<sp/>&amp;&amp;<sp/>current_state<sp/>==<sp/><ref refid="_atividade__04_8c_1aa0aafed44fec19806d8f9ad834be1248a3680d3e43be15ef8b428fe0a64956b90" kindref="member">ST_GREEN</ref>)<sp/>{</highlight></codeline>
<codeline lineno="305"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>countdown_sec<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="306"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="307"><highlight class="normal"></highlight></codeline>
<codeline lineno="308"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;<sp/></highlight><highlight class="comment">/*<sp/>mantém<sp/>callback<sp/>ativo<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="309"><highlight class="normal">}</highlight></codeline>
<codeline lineno="310"><highlight class="normal"></highlight></codeline>
<codeline lineno="316"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>button_irq(uint<sp/>gpio,<sp/>uint32_t<sp/>events)<sp/>{</highlight></codeline>
<codeline lineno="317"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>dir<sp/>=<sp/>(gpio<sp/>==<sp/><ref refid="_atividade__04_8c_1aad905e2ee036ff31a5cc49b248361420" kindref="member">BUTTON_PIN1</ref><sp/>?<sp/>1<sp/>:<sp/>2);</highlight></codeline>
<codeline lineno="318"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Em<sp/>VERMELHO:<sp/>reinicia<sp/>contagem<sp/>e<sp/>registra<sp/>direção<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="319"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(current_state<sp/>==<sp/><ref refid="_atividade__04_8c_1aa0aafed44fec19806d8f9ad834be1248ad2aaf0c286ae52532c96f716b3410aed" kindref="member">ST_RED</ref>)<sp/>{</highlight></codeline>
<codeline lineno="320"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>countdown_sec<sp/><sp/><sp/><sp/><sp/>=<sp/><ref refid="_atividade__04_8c_1ad12a564ad91765abf118b1a1c935a79b" kindref="member">RED_TIME_SEC</ref>;</highlight></codeline>
<codeline lineno="321"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>red_from_ped_dir<sp/><sp/>=<sp/>dir;</highlight></codeline>
<codeline lineno="322"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>oled_show_state(<ref refid="_atividade__04_8c_1aa0aafed44fec19806d8f9ad834be1248ad2aaf0c286ae52532c96f716b3410aed" kindref="member">ST_RED</ref>);</highlight></codeline>
<codeline lineno="323"><highlight class="normal"><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="324"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Em<sp/>VERDE/AMARELO:<sp/>agenda<sp/>travessia<sp/>no<sp/>próximo<sp/>VERMELHO<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="325"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(ped_request_dir<sp/>==<sp/>0<sp/>||<sp/>dir<sp/>==<sp/>1)<sp/>{</highlight></codeline>
<codeline lineno="326"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ped_request_dir<sp/>=<sp/>dir;</highlight></codeline>
<codeline lineno="327"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="328"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>oled_clear();</highlight></codeline>
<codeline lineno="329"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ssd1306_draw_string(oled_buf,<sp/>0,<sp/>24,<sp/></highlight><highlight class="stringliteral">&quot;Pedido<sp/>travessia&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="330"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>render_on_display(oled_buf,<sp/>&amp;full_area);</highlight></codeline>
<codeline lineno="331"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="332"><highlight class="normal">}</highlight></codeline>
<codeline lineno="333"><highlight class="normal"></highlight></codeline>
<codeline lineno="345"><highlight class="normal"></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="_atividade__04_8c_1a840291bc02cba5474a4cb46a9b9566fe" kindref="member">main</ref>(</highlight><highlight class="keywordtype">void</highlight><highlight class="normal">)<sp/>{</highlight></codeline>
<codeline lineno="346"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>1)<sp/>Inicialização<sp/>de<sp/>hardware<sp/>(GPIOs,<sp/>I2C,<sp/>OLED)<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="347"><highlight class="normal"><sp/><sp/><sp/><sp/>hw_init();</highlight></codeline>
<codeline lineno="348"><highlight class="normal"></highlight></codeline>
<codeline lineno="349"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>2)<sp/>Estado<sp/>inicial:<sp/>vermelho<sp/>(LED<sp/>e<sp/>display)<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="350"><highlight class="normal"><sp/><sp/><sp/><sp/>set_led_color(<ref refid="_atividade__04_8c_1aa0aafed44fec19806d8f9ad834be1248ad2aaf0c286ae52532c96f716b3410aed" kindref="member">ST_RED</ref>);</highlight></codeline>
<codeline lineno="351"><highlight class="normal"><sp/><sp/><sp/><sp/>oled_show_state(<ref refid="_atividade__04_8c_1aa0aafed44fec19806d8f9ad834be1248ad2aaf0c286ae52532c96f716b3410aed" kindref="member">ST_RED</ref>);</highlight></codeline>
<codeline lineno="352"><highlight class="normal"></highlight></codeline>
<codeline lineno="353"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>3)<sp/>Configura<sp/>e<sp/>inicia<sp/>o<sp/>timer<sp/>periódico<sp/>de<sp/>1<sp/>Hz<sp/>para<sp/>gerenciamento<sp/>do<sp/>semáforo:</highlight></codeline>
<codeline lineno="354"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/>*<sp/><sp/><sp/><sp/>-<sp/>Intervalo<sp/>de<sp/>1000<sp/>ms<sp/>(1<sp/>segundo)<sp/>entre<sp/>callbacks.</highlight></codeline>
<codeline lineno="355"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/>*<sp/><sp/><sp/><sp/>-<sp/>Offset<sp/>de<sp/>-1000<sp/>ms<sp/>indica<sp/>que<sp/>o<sp/>primeiro<sp/>callback<sp/>ocorre<sp/>imediatamente</highlight></codeline>
<codeline lineno="356"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>após<sp/>a<sp/>chamada,<sp/>sem<sp/>aguardar<sp/>o<sp/>primeiro<sp/>intervalo<sp/>completo.</highlight></codeline>
<codeline lineno="357"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/>*<sp/><sp/><sp/><sp/>-<sp/>`timer_cb`<sp/>é<sp/>a<sp/>função<sp/>de<sp/>callback<sp/>que<sp/>decrementa<sp/>o<sp/>contador,</highlight></codeline>
<codeline lineno="358"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>controla<sp/>o<sp/>buzzer<sp/>e<sp/>gerencia<sp/>as<sp/>transições<sp/>de<sp/>estado<sp/>do<sp/>semáforo.</highlight></codeline>
<codeline lineno="359"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/>*<sp/><sp/><sp/><sp/>-<sp/>`NULL`<sp/>é<sp/>o<sp/>argumento<sp/>de<sp/>user_data<sp/>passado<sp/>ao<sp/>callback<sp/>(não<sp/>utilizado).</highlight></codeline>
<codeline lineno="360"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/>*<sp/><sp/><sp/><sp/>-<sp/>`&amp;timer_1s`<sp/>recebe<sp/>o<sp/>handle<sp/>do<sp/>timer,<sp/>permitindo<sp/>futura<sp/>remoção,<sp/>se<sp/>necessário.</highlight></codeline>
<codeline lineno="361"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="362"><highlight class="normal"><sp/><sp/><sp/><sp/>add_repeating_timer_ms(-1000,<sp/>timer_cb,<sp/>NULL,<sp/>&amp;timer_1s);</highlight></codeline>
<codeline lineno="363"><highlight class="normal"></highlight></codeline>
<codeline lineno="364"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>4)<sp/>Loop<sp/>principal:<sp/>CPU<sp/>aguarda<sp/>em<sp/>idle,<sp/>acordando<sp/>apenas<sp/>por<sp/>IRQ<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="365"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keyword">true</highlight><highlight class="normal">)<sp/>{</highlight></codeline>
<codeline lineno="366"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>tight_loop_contents();</highlight></codeline>
<codeline lineno="367"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="368"><highlight class="normal">}</highlight></codeline>
<codeline lineno="369"><highlight class="normal"></highlight></codeline>
    </programlisting>
    <location file="C:/Users/manoe/OneDrive/TI/EmbarcaTech/Segunda Fase/01_Unid.01_Microcontrolador/Atividades/Cap_04/Atividade_04/Atividade_04/src/Atividade_04.c"/>
  </compounddef>
</doxygen>
