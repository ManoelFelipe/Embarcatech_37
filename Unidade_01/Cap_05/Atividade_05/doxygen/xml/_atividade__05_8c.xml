<?xml version='1.0' encoding='UTF-8' standalone='no'?>
<doxygen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="compound.xsd" version="1.13.2" xml:lang="en-US">
  <compounddef id="_atividade__05_8c" kind="file" language="C++">
    <compoundname>Atividade_05.c</compoundname>
    <includes local="no">stdio.h</includes>
    <includes local="no">string.h</includes>
    <includes local="yes">pico/stdlib.h</includes>
    <includes local="yes">hardware/adc.h</includes>
    <includes local="yes">hardware/dma.h</includes>
    <includes local="yes">hardware/i2c.h</includes>
    <includes refid="ssd1306__i2c_8h" local="yes">ssd1306_i2c.h</includes>
    <includes refid="ssd1306_8h" local="yes">ssd1306.h</includes>
    <includes refid="ssd1306__font_8h" local="yes">ssd1306_font.h</includes>
    <incdepgraph>
      <node id="10">
        <label>ssd1306.h</label>
        <link refid="ssd1306_8h_source"/>
        <childnode refid="8" relation="include">
        </childnode>
      </node>
      <node id="11">
        <label>ssd1306_font.h</label>
        <link refid="ssd1306__font_8h_source"/>
      </node>
      <node id="8">
        <label>ssd1306_i2c.h</label>
        <link refid="ssd1306__i2c_8h_source"/>
        <childnode refid="9" relation="include">
        </childnode>
        <childnode refid="4" relation="include">
        </childnode>
        <childnode refid="7" relation="include">
        </childnode>
      </node>
      <node id="1">
        <label>C:/Users/manoe/OneDrive/TI/EmbarcaTech/Segunda Fase/01_Unid.01_Microcontrolador/Atividades/Cap_05/Atividade_05/src/Atividade_05.c</label>
        <link refid="_atividade__05_8c"/>
        <childnode refid="2" relation="include">
        </childnode>
        <childnode refid="3" relation="include">
        </childnode>
        <childnode refid="4" relation="include">
        </childnode>
        <childnode refid="5" relation="include">
        </childnode>
        <childnode refid="6" relation="include">
        </childnode>
        <childnode refid="7" relation="include">
        </childnode>
        <childnode refid="8" relation="include">
        </childnode>
        <childnode refid="10" relation="include">
        </childnode>
        <childnode refid="11" relation="include">
        </childnode>
      </node>
      <node id="5">
        <label>hardware/adc.h</label>
      </node>
      <node id="6">
        <label>hardware/dma.h</label>
      </node>
      <node id="7">
        <label>hardware/i2c.h</label>
      </node>
      <node id="4">
        <label>pico/stdlib.h</label>
      </node>
      <node id="2">
        <label>stdio.h</label>
      </node>
      <node id="9">
        <label>stdlib.h</label>
      </node>
      <node id="3">
        <label>string.h</label>
      </node>
    </incdepgraph>
    <sectiondef kind="user-defined">
      <header>OLED I²C Mapping</header>
      <description><para>Pinos utilizados pelo barramento I²C dedicado ao display. </para>
</description>
      <memberdef kind="define" id="_atividade__05_8c_1ae8d87fbd2ecb585ea5b5726469914735" prot="public" static="no">
        <name>OLED_I2C_SDA_PIN</name>
        <initializer>14</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<para>GPIO que carrega o sinal SDA </para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/Users/manoe/OneDrive/TI/EmbarcaTech/Segunda Fase/01_Unid.01_Microcontrolador/Atividades/Cap_05/Atividade_05/src/Atividade_05.c" line="72" column="9" bodyfile="C:/Users/manoe/OneDrive/TI/EmbarcaTech/Segunda Fase/01_Unid.01_Microcontrolador/Atividades/Cap_05/Atividade_05/src/Atividade_05.c" bodystart="72" bodyend="-1"/>
      </memberdef>
      <memberdef kind="define" id="_atividade__05_8c_1a4461f81a16bc2633c7295aba245a31b3" prot="public" static="no">
        <name>OLED_I2C_SCL_PIN</name>
        <initializer>15</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<para>GPIO que carrega o sinal SCL </para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/Users/manoe/OneDrive/TI/EmbarcaTech/Segunda Fase/01_Unid.01_Microcontrolador/Atividades/Cap_05/Atividade_05/src/Atividade_05.c" line="73" column="9" bodyfile="C:/Users/manoe/OneDrive/TI/EmbarcaTech/Segunda Fase/01_Unid.01_Microcontrolador/Atividades/Cap_05/Atividade_05/src/Atividade_05.c" bodystart="73" bodyend="-1"/>
      </memberdef>
    </sectiondef>
    <sectiondef kind="define">
      <memberdef kind="define" id="_atividade__05_8c_1ad0c329adebc27917fc0a4f51079acf6a" prot="public" static="no">
        <name>SAMPLES</name>
        <initializer>100</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<para>Nº de amostras que compõem cada bloco de DMA </para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/Users/manoe/OneDrive/TI/EmbarcaTech/Segunda Fase/01_Unid.01_Microcontrolador/Atividades/Cap_05/Atividade_05/src/Atividade_05.c" line="77" column="9" bodyfile="C:/Users/manoe/OneDrive/TI/EmbarcaTech/Segunda Fase/01_Unid.01_Microcontrolador/Atividades/Cap_05/Atividade_05/src/Atividade_05.c" bodystart="77" bodyend="-1"/>
      </memberdef>
      <memberdef kind="define" id="_atividade__05_8c_1ae2377e1385d49cf9c9ba44a8d07c94db" prot="public" static="no">
        <name>TEMP_UPDATE_MS</name>
        <initializer>500</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<para>Intervalo (ms) entre atualizações do display </para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/Users/manoe/OneDrive/TI/EmbarcaTech/Segunda Fase/01_Unid.01_Microcontrolador/Atividades/Cap_05/Atividade_05/src/Atividade_05.c" line="78" column="9" bodyfile="C:/Users/manoe/OneDrive/TI/EmbarcaTech/Segunda Fase/01_Unid.01_Microcontrolador/Atividades/Cap_05/Atividade_05/src/Atividade_05.c" bodystart="78" bodyend="-1"/>
      </memberdef>
      <memberdef kind="define" id="_atividade__05_8c_1ad9ecf80e1eac083d16ec47f9d3aeb39f" prot="public" static="no">
        <name>I2C_PORT</name>
        <initializer>i2c1</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<para>Porta I²C utilizada pinos GP4/GP5 no Pico </para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/Users/manoe/OneDrive/TI/EmbarcaTech/Segunda Fase/01_Unid.01_Microcontrolador/Atividades/Cap_05/Atividade_05/src/Atividade_05.c" line="80" column="9" bodyfile="C:/Users/manoe/OneDrive/TI/EmbarcaTech/Segunda Fase/01_Unid.01_Microcontrolador/Atividades/Cap_05/Atividade_05/src/Atividade_05.c" bodystart="80" bodyend="-1"/>
      </memberdef>
      <memberdef kind="define" id="_atividade__05_8c_1a31568ea8caf00a3ec699c01652c771d0" prot="public" static="no">
        <name>I2C_BAUDRATE</name>
        <initializer>400000</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<para>400 kHz – modo Fast I²C </para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/Users/manoe/OneDrive/TI/EmbarcaTech/Segunda Fase/01_Unid.01_Microcontrolador/Atividades/Cap_05/Atividade_05/src/Atividade_05.c" line="81" column="9" bodyfile="C:/Users/manoe/OneDrive/TI/EmbarcaTech/Segunda Fase/01_Unid.01_Microcontrolador/Atividades/Cap_05/Atividade_05/src/Atividade_05.c" bodystart="81" bodyend="-1"/>
      </memberdef>
    </sectiondef>
    <sectiondef kind="var">
      <memberdef kind="variable" id="_atividade__05_8c_1ab32867340b6a3344e4e30c0b4a954c77" prot="public" static="yes" mutable="no">
        <type>uint16_t</type>
        <definition>uint16_t adc_buffer[SAMPLES]</definition>
        <argsstring>[SAMPLES]</argsstring>
        <name>adc_buffer</name>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<para>Destino de cada transferência DMA </para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/Users/manoe/OneDrive/TI/EmbarcaTech/Segunda Fase/01_Unid.01_Microcontrolador/Atividades/Cap_05/Atividade_05/src/Atividade_05.c" line="92" column="17" bodyfile="C:/Users/manoe/OneDrive/TI/EmbarcaTech/Segunda Fase/01_Unid.01_Microcontrolador/Atividades/Cap_05/Atividade_05/src/Atividade_05.c" bodystart="92" bodyend="-1"/>
      </memberdef>
      <memberdef kind="variable" id="_atividade__05_8c_1a456684b326733e9d7a283b12f7316770" prot="public" static="yes" mutable="no">
        <type>int</type>
        <definition>int dma_chan</definition>
        <argsstring></argsstring>
        <name>dma_chan</name>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<para>Canal DMA alocado </para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/Users/manoe/OneDrive/TI/EmbarcaTech/Segunda Fase/01_Unid.01_Microcontrolador/Atividades/Cap_05/Atividade_05/src/Atividade_05.c" line="93" column="12" bodyfile="C:/Users/manoe/OneDrive/TI/EmbarcaTech/Segunda Fase/01_Unid.01_Microcontrolador/Atividades/Cap_05/Atividade_05/src/Atividade_05.c" bodystart="93" bodyend="-1"/>
      </memberdef>
      <memberdef kind="variable" id="_atividade__05_8c_1adbf7d451aafdcb17b85cc204bb411e4b" prot="public" static="yes" mutable="no">
        <type>uint8_t</type>
        <definition>uint8_t fb[ssd1306_buffer_length]</definition>
        <argsstring>[ssd1306_buffer_length]</argsstring>
        <name>fb</name>
        <initializer>= {0}</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<para>Buffer de vídeo (frame‑buffer) para o display – 1 byte por página x largura. O tamanho é definido pela própria biblioteca SSD1306. </para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/Users/manoe/OneDrive/TI/EmbarcaTech/Segunda Fase/01_Unid.01_Microcontrolador/Atividades/Cap_05/Atividade_05/src/Atividade_05.c" line="98" column="16" bodyfile="C:/Users/manoe/OneDrive/TI/EmbarcaTech/Segunda Fase/01_Unid.01_Microcontrolador/Atividades/Cap_05/Atividade_05/src/Atividade_05.c" bodystart="98" bodyend="98"/>
      </memberdef>
      <memberdef kind="variable" id="_atividade__05_8c_1a8a2d3a68931f9ca89d4fe36361492a6a" prot="public" static="yes" mutable="no">
        <type>struct <ref refid="structrender__area" kindref="compound">render_area</ref></type>
        <definition>struct render_area full_area</definition>
        <argsstring></argsstring>
        <name>full_area</name>
        <initializer>= {
    .start_column = 0,
    .end_column   = ssd1306_width  - 1,
    .start_page   = 0,
    .end_page     = ssd1306_n_pages - 1,
}</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<para>Área que cobre toda a tela (0,0 –&gt; 127,63) </para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/Users/manoe/OneDrive/TI/EmbarcaTech/Segunda Fase/01_Unid.01_Microcontrolador/Atividades/Cap_05/Atividade_05/src/Atividade_05.c" line="101" column="25" bodyfile="C:/Users/manoe/OneDrive/TI/EmbarcaTech/Segunda Fase/01_Unid.01_Microcontrolador/Atividades/Cap_05/Atividade_05/src/Atividade_05.c" bodystart="101" bodyend="106"/>
      </memberdef>
    </sectiondef>
    <sectiondef kind="func">
      <memberdef kind="function" id="_atividade__05_8c_1a2684f7ae566b32171366465dee5473e1" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>float</type>
        <definition>static float adc_to_celsius</definition>
        <argsstring>(uint16_t raw)</argsstring>
        <name>adc_to_celsius</name>
        <param>
          <type>uint16_t</type>
          <declname>raw</declname>
        </param>
        <briefdescription>
<para>Converte um valor digital do ADC (12 bits) para temperatura em °C. </para>
        </briefdescription>
        <detaileddescription>
<para>Fórmula do datasheet do RP2040: T = 27 – (Vout – 0,706) / 0,001721 onde Vout = ADC * Vref / 4096</para>
<para><formula id="0">\[ T = 27 − \frac{V_{out} − 0{,}706}{0{,}001721} \]</formula> onde <formula id="1">$ V_{out} = ADC_{raw} \times V_{ref} / 4096 $</formula>.</para>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>raw</parametername>
</parameternamelist>
<parameterdescription>
<para>Valor bruto do ADC (0–4095) </para>
</parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para>Temperatura em graus Celsius (float) </para>
</simplesect>
</para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/Users/manoe/OneDrive/TI/EmbarcaTech/Segunda Fase/01_Unid.01_Microcontrolador/Atividades/Cap_05/Atividade_05/src/Atividade_05.c" line="123" column="14" bodyfile="C:/Users/manoe/OneDrive/TI/EmbarcaTech/Segunda Fase/01_Unid.01_Microcontrolador/Atividades/Cap_05/Atividade_05/src/Atividade_05.c" bodystart="123" bodyend="131" declfile="C:/Users/manoe/OneDrive/TI/EmbarcaTech/Segunda Fase/01_Unid.01_Microcontrolador/Atividades/Cap_05/Atividade_05/src/Atividade_05.c" declline="84" declcolumn="14"/>
      </memberdef>
      <memberdef kind="function" id="_atividade__05_8c_1aa4954d4c8b738fc739c26c5f3d483dc3" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>static void init_display</definition>
        <argsstring>(void)</argsstring>
        <name>init_display</name>
        <param>
          <type>void</type>
        </param>
        <briefdescription>
<para>Inicializa o barramento I²C e o display SSD1306. </para>
        </briefdescription>
        <detaileddescription>
<para>Nesta aplicação mantemos um frame‑buffer local (<computeroutput>fb</computeroutput>) e utilizamos <computeroutput>render_on_display()</computeroutput> para enviá‑lo. Poderíamos, de maneira equivalente, empregar <computeroutput>ssd1306_clear()</computeroutput> + <computeroutput>ssd1306_show()</computeroutput>, mas preferimos o fluxo explícito para evidenciar os passos envolvidos. (Ver display_temperature). </para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/Users/manoe/OneDrive/TI/EmbarcaTech/Segunda Fase/01_Unid.01_Microcontrolador/Atividades/Cap_05/Atividade_05/src/Atividade_05.c" line="140" column="13" bodyfile="C:/Users/manoe/OneDrive/TI/EmbarcaTech/Segunda Fase/01_Unid.01_Microcontrolador/Atividades/Cap_05/Atividade_05/src/Atividade_05.c" bodystart="140" bodyend="162" declfile="C:/Users/manoe/OneDrive/TI/EmbarcaTech/Segunda Fase/01_Unid.01_Microcontrolador/Atividades/Cap_05/Atividade_05/src/Atividade_05.c" declline="85" declcolumn="14"/>
      </memberdef>
      <memberdef kind="function" id="_atividade__05_8c_1a58741f53e3e22ec8db7e66ded93d3b79" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>static void init_adc</definition>
        <argsstring>(void)</argsstring>
        <name>init_adc</name>
        <param>
          <type>void</type>
        </param>
        <briefdescription>
<para>Configura ADC (canal 4) e inicia conversão contínua. </para>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/Users/manoe/OneDrive/TI/EmbarcaTech/Segunda Fase/01_Unid.01_Microcontrolador/Atividades/Cap_05/Atividade_05/src/Atividade_05.c" line="167" column="13" bodyfile="C:/Users/manoe/OneDrive/TI/EmbarcaTech/Segunda Fase/01_Unid.01_Microcontrolador/Atividades/Cap_05/Atividade_05/src/Atividade_05.c" bodystart="167" bodyend="187" declfile="C:/Users/manoe/OneDrive/TI/EmbarcaTech/Segunda Fase/01_Unid.01_Microcontrolador/Atividades/Cap_05/Atividade_05/src/Atividade_05.c" declline="86" declcolumn="14"/>
      </memberdef>
      <memberdef kind="function" id="_atividade__05_8c_1a28e51cbdfc72a78f22af56e7efe44236" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>static void init_dma</definition>
        <argsstring>(void)</argsstring>
        <name>init_dma</name>
        <param>
          <type>void</type>
        </param>
        <briefdescription>
<para>Configura canal DMA para transferir SAMPLES valores do FIFO do ADC para adc_buffer. Após a conclusão, o canal gera interrupção (opcional) ou podemos bloquear aguardando no laço principal. </para>
        </briefdescription>
        <detaileddescription>
<para>A transferência é de 16 bits porque o registrador FIFO fornece os 12 bits válidos alinhados à direita. O endereço de leitura é fixo (FIFO) e o de escrita é incrementado dentro de <computeroutput>adc_buffer</computeroutput>. </para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/Users/manoe/OneDrive/TI/EmbarcaTech/Segunda Fase/01_Unid.01_Microcontrolador/Atividades/Cap_05/Atividade_05/src/Atividade_05.c" line="198" column="13" bodyfile="C:/Users/manoe/OneDrive/TI/EmbarcaTech/Segunda Fase/01_Unid.01_Microcontrolador/Atividades/Cap_05/Atividade_05/src/Atividade_05.c" bodystart="198" bodyend="223" declfile="C:/Users/manoe/OneDrive/TI/EmbarcaTech/Segunda Fase/01_Unid.01_Microcontrolador/Atividades/Cap_05/Atividade_05/src/Atividade_05.c" declline="87" declcolumn="14"/>
      </memberdef>
      <memberdef kind="function" id="_atividade__05_8c_1aa738913f77585a2a85d9c4c3406555ab" prot="public" static="yes" const="no" explicit="no" inline="yes" virt="non-virtual">
        <type>void</type>
        <definition>static void restart_dma</definition>
        <argsstring>(void)</argsstring>
        <name>restart_dma</name>
        <param>
          <type>void</type>
        </param>
        <briefdescription>
<para>Configura o canal DMA para o próximo bloco de <computeroutput>SAMPLES</computeroutput> amostras. </para>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/Users/manoe/OneDrive/TI/EmbarcaTech/Segunda Fase/01_Unid.01_Microcontrolador/Atividades/Cap_05/Atividade_05/src/Atividade_05.c" line="228" column="20" bodyfile="C:/Users/manoe/OneDrive/TI/EmbarcaTech/Segunda Fase/01_Unid.01_Microcontrolador/Atividades/Cap_05/Atividade_05/src/Atividade_05.c" bodystart="228" bodyend="234" declfile="C:/Users/manoe/OneDrive/TI/EmbarcaTech/Segunda Fase/01_Unid.01_Microcontrolador/Atividades/Cap_05/Atividade_05/src/Atividade_05.c" declline="88" declcolumn="20"/>
      </memberdef>
      <memberdef kind="function" id="_atividade__05_8c_1a64c5f255eb084e616cb7842bb3468e9c" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>static void display_temperature</definition>
        <argsstring>(float temp_c)</argsstring>
        <name>display_temperature</name>
        <param>
          <type>float</type>
          <declname>temp_c</declname>
        </param>
        <briefdescription>
<para>Atualiza o display com a temperatura fornecida. </para>
        </briefdescription>
        <detaileddescription>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>temp_c</parametername>
</parameternamelist>
<parameterdescription>
<para>Temperatura em graus Celsius </para>
</parameterdescription>
</parameteritem>
</parameterlist>
</para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/Users/manoe/OneDrive/TI/EmbarcaTech/Segunda Fase/01_Unid.01_Microcontrolador/Atividades/Cap_05/Atividade_05/src/Atividade_05.c" line="241" column="13" bodyfile="C:/Users/manoe/OneDrive/TI/EmbarcaTech/Segunda Fase/01_Unid.01_Microcontrolador/Atividades/Cap_05/Atividade_05/src/Atividade_05.c" bodystart="241" bodyend="263" declfile="C:/Users/manoe/OneDrive/TI/EmbarcaTech/Segunda Fase/01_Unid.01_Microcontrolador/Atividades/Cap_05/Atividade_05/src/Atividade_05.c" declline="89" declcolumn="14"/>
      </memberdef>
      <memberdef kind="function" id="_atividade__05_8c_1a840291bc02cba5474a4cb46a9b9566fe" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int</type>
        <definition>int main</definition>
        <argsstring>(void)</argsstring>
        <name>main</name>
        <param>
          <type>void</type>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/Users/manoe/OneDrive/TI/EmbarcaTech/Segunda Fase/01_Unid.01_Microcontrolador/Atividades/Cap_05/Atividade_05/src/Atividade_05.c" line="266" column="5" bodyfile="C:/Users/manoe/OneDrive/TI/EmbarcaTech/Segunda Fase/01_Unid.01_Microcontrolador/Atividades/Cap_05/Atividade_05/src/Atividade_05.c" bodystart="266" bodyend="299"/>
      </memberdef>
    </sectiondef>
    <briefdescription>
<para>Sistema de Aquisição de Temperatura com DMA e Interface I2C em Microcontrolador RP2040. </para>
    </briefdescription>
    <detaileddescription>
<para><verbatim>     Este progrma tem como objetivo demonstar como utilizar:
        * ADC interno (canal 4) para ler o sensor de temperatura
        * Controlador DMA para transferir automaticamente as amostras do FIFO do ADC para a RAM
        * Barramento I2C para atualizar um display OLED SSD1306

     O ciclo de trabalho é:
        1. O ADC é configurado para amostragem contínua do canal 4.
        2. Um canal de DMA lê amostras(SAMPLES) do FIFO e armazena em um buffer.
        3. Quando o bloco de DMA termina, calculamos a média, convertemos em °C e
           enviamos o valor formatado para o display.
        4. O DMA é usado sem intervenção intensiva da CPU, permitindo que o núcleo possa
           ficar em espera reduzindo consumo.
</verbatim></para>
<para><simplesect kind="note"><para>Também foi esclarecida a razão de se utilizar <computeroutput>memset()</computeroutput> + <computeroutput>render_on_display()</computeroutput> em vez dos atalhos <computeroutput>ssd1306_clear()</computeroutput> e <computeroutput>ssd1306_show()</computeroutput>. O uso direto do frame‑buffer permite:<orderedlist>
<listitem><para>Renderizar apenas regiões específicas da tela, economizando tráfego I²C quando necessário;</para>
</listitem><listitem><para>Manter a lógica didática de <emphasis>clear → draw → show</emphasis> explícita;</para>
</listitem><listitem><para>Suportar múltiplos frame‑buffers simultâneos caso o projeto evolua para animações ou janelas sobrepostas. Caso deseje simplificar, basta substituir o bloco marcado em display_temperature() pelos atalhos da biblioteca.</para>
</listitem></orderedlist>
</para>
</simplesect>
Não foi tratado os caracteres especiais que apace no display OLED então, a temperatura médida a exemplo 26 55 c --&gt; 26,55 ºc A blibioteca atual <ref refid="ssd1306__font_8h_source" kindref="compound">ssd1306_font.h</ref> e ssd1306_i2c.c só reconhece acaracteres simples maiúsculas.</para>
<para>@hardware Requisitos de hardware: • Raspberry Pi Pico / Pico W • Display OLED SSD1306 conectado aos pinos I2C: – SDA → GP14  (GPIO 14) – SCL → GP55  (GPIO 15)</para>
<para>@compile Compilação (exemplo de CMake): add_executable(Atividade_05 <ref refid="_atividade__05_8c" kindref="compound">src/Atividade_05.c</ref> lib/ssd1306_i2c.c )</para>
<para>IMPORTANTE: • Todas as funções estão extensivamente comentadas, estilo Doxygen para fins didáticos. • O código assume Vref = 3,3 V (padrão do RP2040) para a conversão do ADC. • Ajuste SAMPLES e TEMP_UPDATE_MS conforme necessidade.</para>
<para><simplesect kind="author"><para>Manoel Furtado </para>
</simplesect>
<simplesect kind="date"><para>18 mai 2025 </para>
</simplesect>
<simplesect kind="copyright"><para>2025 Manoel Furtado (MIT License) (veja LICENSE.md) </para>
</simplesect>
</para>
    </detaileddescription>
    <programlisting>
<codeline lineno="1"><highlight class="normal"></highlight></codeline>
<codeline lineno="54"><highlight class="normal"></highlight></codeline>
<codeline lineno="55"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;stdio.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="56"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;string.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="57"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;pico/stdlib.h&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="58"><highlight class="normal"></highlight></codeline>
<codeline lineno="59"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;hardware/adc.h&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="60"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;hardware/dma.h&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="61"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;hardware/i2c.h&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="62"><highlight class="normal"></highlight></codeline>
<codeline lineno="63"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;ssd1306_i2c.h&quot;</highlight><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="64"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;ssd1306.h&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="65"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;ssd1306_font.h&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="66"><highlight class="normal"></highlight></codeline>
<codeline lineno="67"><highlight class="normal"></highlight><highlight class="comment">/*<sp/>------------------------<sp/>GPIO<sp/>Mapping<sp/>--------------------------<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="72"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>OLED_I2C_SDA_PIN<sp/><sp/><sp/>14<sp/><sp/></highlight><highlight class="preprocessor"></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="73"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>OLED_I2C_SCL_PIN<sp/><sp/><sp/>15<sp/><sp/></highlight><highlight class="preprocessor"></highlight><highlight class="preprocessor"></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="75"><highlight class="normal"></highlight></codeline>
<codeline lineno="76"><highlight class="normal"></highlight><highlight class="comment">/*<sp/>---------------------------<sp/>Parâmetros<sp/>do<sp/>sistema<sp/>-------------------------<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="77"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>SAMPLES<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>100<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="preprocessor"></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="78"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>TEMP_UPDATE_MS<sp/><sp/><sp/><sp/><sp/><sp/>500<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="preprocessor"></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="79"><highlight class="normal"></highlight></codeline>
<codeline lineno="80"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>I2C_PORT<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>i2c1<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="preprocessor"></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="81"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>I2C_BAUDRATE<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>400000<sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="preprocessor"></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="82"><highlight class="normal"></highlight></codeline>
<codeline lineno="83"><highlight class="normal"></highlight><highlight class="comment">/*<sp/>----------------------<sp/>Protótipos<sp/>de<sp/>funções<sp/>-------------------<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="84"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>adc_to_celsius(uint16_t<sp/>raw);</highlight></codeline>
<codeline lineno="85"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><sp/>init_display(</highlight><highlight class="keywordtype">void</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="86"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><sp/>init_adc(</highlight><highlight class="keywordtype">void</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="87"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><sp/>init_dma(</highlight><highlight class="keywordtype">void</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="88"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">inline</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>restart_dma(</highlight><highlight class="keywordtype">void</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="89"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><sp/>display_temperature(</highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>temp_c);</highlight></codeline>
<codeline lineno="90"><highlight class="normal"></highlight></codeline>
<codeline lineno="91"><highlight class="normal"></highlight><highlight class="comment">/*<sp/>---------------------------<sp/>Buffers<sp/>e<sp/>variáveis<sp/>---------------------------<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="92"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/>uint16_t<sp/>adc_buffer[<ref refid="_atividade__05_8c_1ad0c329adebc27917fc0a4f51079acf6a" kindref="member">SAMPLES</ref>];<sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="93"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>dma_chan;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="94"><highlight class="normal"></highlight></codeline>
<codeline lineno="98"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/>uint8_t<sp/>fb[ssd1306_buffer_length]<sp/>=<sp/>{0};</highlight></codeline>
<codeline lineno="99"><highlight class="normal"></highlight></codeline>
<codeline lineno="101"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">struct<sp/></highlight><highlight class="normal"><ref refid="structrender__area" kindref="compound">render_area</ref><sp/>full_area<sp/>=<sp/>{</highlight></codeline>
<codeline lineno="102"><highlight class="normal"><sp/><sp/><sp/><sp/>.start_column<sp/>=<sp/>0,</highlight></codeline>
<codeline lineno="103"><highlight class="normal"><sp/><sp/><sp/><sp/>.end_column<sp/><sp/><sp/>=<sp/>ssd1306_width<sp/><sp/>-<sp/>1,</highlight></codeline>
<codeline lineno="104"><highlight class="normal"><sp/><sp/><sp/><sp/>.start_page<sp/><sp/><sp/>=<sp/>0,</highlight></codeline>
<codeline lineno="105"><highlight class="normal"><sp/><sp/><sp/><sp/>.end_page<sp/><sp/><sp/><sp/><sp/>=<sp/>ssd1306_n_pages<sp/>-<sp/>1,</highlight></codeline>
<codeline lineno="106"><highlight class="normal">};</highlight></codeline>
<codeline lineno="107"><highlight class="normal"></highlight></codeline>
<codeline lineno="108"><highlight class="normal"></highlight><highlight class="comment">/*<sp/>---------------------------<sp/>Funções<sp/>auxiliares<sp/>---------------------------<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="109"><highlight class="normal"></highlight></codeline>
<codeline lineno="123"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>adc_to_celsius(uint16_t<sp/>raw)<sp/></highlight></codeline>
<codeline lineno="124"><highlight class="normal">{</highlight></codeline>
<codeline lineno="125"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>VREF<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>3.3f;<sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Tensão<sp/>de<sp/>referência<sp/>do<sp/>ADC</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="126"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>CONVERT<sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>VREF<sp/>/<sp/>4096.0f;<sp/></highlight><highlight class="comment">/*<sp/>Tensão<sp/>por<sp/>LSB<sp/>(12 bits)<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="127"><highlight class="normal"></highlight></codeline>
<codeline lineno="128"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>voltage<sp/><sp/><sp/><sp/>=<sp/>(float)raw<sp/>*<sp/>CONVERT;<sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Converte<sp/>valor<sp/>para<sp/>tensão</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="129"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>temperature<sp/>=<sp/>27.0f<sp/>-<sp/>(voltage<sp/>-<sp/>0.706f)<sp/>/<sp/>0.001721f;<sp/><sp/></highlight><highlight class="comment">//<sp/>Fórmula<sp/>do<sp/>datasheet<sp/>do<sp/>RP2040</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="130"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>temperature;</highlight></codeline>
<codeline lineno="131"><highlight class="normal">}</highlight></codeline>
<codeline lineno="132"><highlight class="normal"></highlight></codeline>
<codeline lineno="140"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>init_display(</highlight><highlight class="keywordtype">void</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="141"><highlight class="normal">{</highlight></codeline>
<codeline lineno="142"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Configura<sp/>I2C1</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="143"><highlight class="normal"><sp/><sp/><sp/><sp/>i2c_init(<ref refid="_atividade__05_8c_1ad9ecf80e1eac083d16ec47f9d3aeb39f" kindref="member">I2C_PORT</ref>,<sp/><ref refid="_atividade__05_8c_1a31568ea8caf00a3ec699c01652c771d0" kindref="member">I2C_BAUDRATE</ref>);<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Clock<sp/>=<sp/>400 kHz</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="144"><highlight class="normal"><sp/><sp/><sp/><sp/>gpio_set_function(<ref refid="_atividade__05_8c_1ae8d87fbd2ecb585ea5b5726469914735" kindref="member">OLED_I2C_SDA_PIN</ref>,<sp/>GPIO_FUNC_I2C);<sp/><sp/></highlight><highlight class="comment">//<sp/>SDA</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="145"><highlight class="normal"><sp/><sp/><sp/><sp/>gpio_set_function(<ref refid="_atividade__05_8c_1a4461f81a16bc2633c7295aba245a31b3" kindref="member">OLED_I2C_SCL_PIN</ref>,<sp/>GPIO_FUNC_I2C);<sp/><sp/></highlight><highlight class="comment">//<sp/>SCL</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="146"><highlight class="normal"><sp/><sp/><sp/><sp/>gpio_pull_up(<ref refid="_atividade__05_8c_1ae8d87fbd2ecb585ea5b5726469914735" kindref="member">OLED_I2C_SDA_PIN</ref>);</highlight></codeline>
<codeline lineno="147"><highlight class="normal"><sp/><sp/><sp/><sp/>gpio_pull_up(<ref refid="_atividade__05_8c_1a4461f81a16bc2633c7295aba245a31b3" kindref="member">OLED_I2C_SCL_PIN</ref>);</highlight></codeline>
<codeline lineno="148"><highlight class="normal"></highlight></codeline>
<codeline lineno="149"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Inicializa<sp/>hardware<sp/>do<sp/>display</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="150"><highlight class="normal"><sp/><sp/><sp/><sp/>ssd1306_init();</highlight></codeline>
<codeline lineno="151"><highlight class="normal"></highlight></codeline>
<codeline lineno="152"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Calcula<sp/>comprimento<sp/>do<sp/>buffer<sp/>de<sp/>renderização<sp/>completo</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="153"><highlight class="normal"><sp/><sp/><sp/><sp/>calculate_render_area_buffer_length(&amp;full_area);</highlight></codeline>
<codeline lineno="154"><highlight class="normal"></highlight></codeline>
<codeline lineno="155"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Limpa<sp/>memória<sp/>do<sp/>framebuffer<sp/>e<sp/>exibe<sp/>tela<sp/>em<sp/>branco</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="156"><highlight class="normal"><sp/><sp/><sp/><sp/>memset(fb,<sp/>0,<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(fb));</highlight></codeline>
<codeline lineno="157"><highlight class="normal"><sp/><sp/><sp/><sp/>render_on_display(fb,<sp/>&amp;full_area);</highlight></codeline>
<codeline lineno="158"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Alternativa<sp/>simplificada:</highlight></codeline>
<codeline lineno="159"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/>*<sp/><sp/><sp/><sp/><sp/>ssd1306_clear();</highlight></codeline>
<codeline lineno="160"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/>*<sp/><sp/><sp/><sp/><sp/>ssd1306_show();</highlight></codeline>
<codeline lineno="161"><highlight class="comment"><sp/><sp/><sp/><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="162"><highlight class="normal">}</highlight></codeline>
<codeline lineno="163"><highlight class="normal"></highlight></codeline>
<codeline lineno="167"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>init_adc(</highlight><highlight class="keywordtype">void</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="168"><highlight class="normal">{</highlight></codeline>
<codeline lineno="169"><highlight class="normal"><sp/><sp/><sp/><sp/>adc_init();<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Habilita<sp/>bloco<sp/>ADC</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="170"><highlight class="normal"><sp/><sp/><sp/><sp/>adc_set_temp_sensor_enabled(</highlight><highlight class="keyword">true</highlight><highlight class="normal">);<sp/><sp/></highlight><highlight class="comment">//<sp/>Conecta<sp/>sensor<sp/>de<sp/>temperatura<sp/>ao<sp/>canal<sp/>4</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="171"><highlight class="normal"><sp/><sp/><sp/><sp/>adc_select_input(4);<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Seleciona<sp/>canal<sp/>4</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="172"><highlight class="normal"></highlight></codeline>
<codeline lineno="173"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>FIFO<sp/>configurado<sp/>para<sp/>amostragem<sp/>contínua:</highlight></codeline>
<codeline lineno="174"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/>*<sp/><sp/>-<sp/>shift<sp/>left<sp/>=<sp/>false<sp/>(mantém<sp/>valor<sp/>de<sp/>12<sp/>bits)</highlight></codeline>
<codeline lineno="175"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/>*<sp/><sp/>-<sp/>dreq_en<sp/><sp/><sp/><sp/>=<sp/>true<sp/><sp/>(gera<sp/>solicitação<sp/>DMA)</highlight></codeline>
<codeline lineno="176"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/>*<sp/><sp/>-<sp/>dreq_thresh=<sp/>1<sp/><sp/><sp/><sp/><sp/>(quando<sp/>≥1<sp/>amostra<sp/>FIFO<sp/>aciona<sp/>DREQ)</highlight></codeline>
<codeline lineno="177"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="178"><highlight class="normal"><sp/><sp/><sp/><sp/>adc_fifo_setup(</highlight></codeline>
<codeline lineno="179"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">,<sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>enable<sp/>FIFO</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="180"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">,<sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>enable<sp/>DMA<sp/>data<sp/>request<sp/>(DREQ)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="181"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>1,<sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>DREQ<sp/>quando<sp/>&gt;=1</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="182"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">,<sp/><sp/></highlight><highlight class="comment">//<sp/>disable<sp/>ERR<sp/>bit</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="183"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal"><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>não<sp/>deslocar<sp/>bits</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="184"><highlight class="normal"><sp/><sp/><sp/><sp/>);</highlight></codeline>
<codeline lineno="185"><highlight class="normal"></highlight></codeline>
<codeline lineno="186"><highlight class="normal"><sp/><sp/><sp/><sp/>adc_run(</highlight><highlight class="keyword">true</highlight><highlight class="normal">);<sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Inicia<sp/>conversão<sp/>contínua</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="187"><highlight class="normal">}</highlight></codeline>
<codeline lineno="188"><highlight class="normal"></highlight></codeline>
<codeline lineno="198"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>init_dma(</highlight><highlight class="keywordtype">void</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="199"><highlight class="normal">{</highlight></codeline>
<codeline lineno="200"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Obtém<sp/>canal<sp/>livre<sp/>e<sp/>configuração padrão<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="201"><highlight class="normal"><sp/><sp/><sp/><sp/>dma_chan<sp/>=<sp/>dma_claim_unused_channel(</highlight><highlight class="keyword">true</highlight><highlight class="normal">);<sp/></highlight><highlight class="comment">//<sp/>Requisita<sp/>um<sp/>canal<sp/>DMA<sp/>disponível</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="202"><highlight class="normal"><sp/><sp/><sp/><sp/>dma_channel_config<sp/>cfg<sp/>=<sp/>dma_channel_get_default_config(dma_chan);<sp/></highlight><highlight class="comment">//<sp/>Obtem<sp/>configuração<sp/>padrão</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="203"><highlight class="normal"></highlight></codeline>
<codeline lineno="204"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>--------------------<sp/>Ajustes<sp/>específicos<sp/>----------------------------<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="205"><highlight class="normal"><sp/><sp/><sp/><sp/>channel_config_set_transfer_data_size(&amp;cfg,<sp/>DMA_SIZE_16);<sp/></highlight><highlight class="comment">//<sp/>Cada<sp/>leitura<sp/>é<sp/>de<sp/>16<sp/>bits</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="206"><highlight class="normal"><sp/><sp/><sp/><sp/>channel_config_set_read_increment<sp/><sp/>(&amp;cfg,<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">);<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Endereço<sp/>fixo<sp/>(registrador<sp/>ADC<sp/>FIFO)<sp/>-<sp/>FIFO:<sp/>endereço<sp/>fixo</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="207"><highlight class="normal"><sp/><sp/><sp/><sp/>channel_config_set_write_increment<sp/>(&amp;cfg,<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">);<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Incrementa<sp/>para<sp/>armazenar<sp/>em<sp/>adc_buffer[]<sp/>-<sp/>Buffer:<sp/>índice<sp/>++<sp/></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="208"><highlight class="normal"><sp/><sp/><sp/><sp/>channel_config_set_dreq<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>(&amp;cfg,<sp/>DREQ_ADC);<sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Acionado<sp/>pelo<sp/>ADC<sp/>-<sp/>Dispara<sp/>automaticamente<sp/>com<sp/>dados<sp/>do<sp/>ADC</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="209"><highlight class="normal"></highlight></codeline>
<codeline lineno="210"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Configura<sp/>sem<sp/>iniciar<sp/>ainda<sp/>(start=false)<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="211"><highlight class="normal"><sp/><sp/><sp/><sp/>dma_channel_configure(</highlight></codeline>
<codeline lineno="212"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dma_chan,</highlight></codeline>
<codeline lineno="213"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&amp;cfg,</highlight></codeline>
<codeline lineno="214"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>adc_buffer,<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Destino</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="215"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&amp;adc_hw-&gt;fifo,<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Origem</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="216"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="_atividade__05_8c_1ad0c329adebc27917fc0a4f51079acf6a" kindref="member">SAMPLES</ref>,<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Quantidade<sp/>de<sp/>transferências</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="217"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Não<sp/>iniciar<sp/>agora</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="218"><highlight class="normal"><sp/><sp/><sp/><sp/>);</highlight></codeline>
<codeline lineno="219"><highlight class="normal"></highlight></codeline>
<codeline lineno="220"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>----<sp/>Opcional:<sp/>Pode<sp/>configurar<sp/>interrupção,<sp/>mas<sp/>para<sp/>simplicidade</highlight></codeline>
<codeline lineno="221"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>o<sp/>loop<sp/>principal<sp/>aguardará<sp/>a<sp/>conclusão<sp/>com</highlight></codeline>
<codeline lineno="222"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dma_channel_wait_for_finish_blocking()<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>----<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="223"><highlight class="normal">}</highlight></codeline>
<codeline lineno="224"><highlight class="normal"></highlight></codeline>
<codeline lineno="228"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">inline</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>restart_dma(</highlight><highlight class="keywordtype">void</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="229"><highlight class="normal">{</highlight></codeline>
<codeline lineno="230"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Reinicia<sp/>contagem<sp/>e<sp/>recomeça<sp/>imediatamente<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="231"><highlight class="normal"><sp/><sp/><sp/><sp/>dma_channel_set_read_addr<sp/><sp/>(dma_chan,<sp/>&amp;adc_hw-&gt;fifo,<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="232"><highlight class="normal"><sp/><sp/><sp/><sp/>dma_channel_set_write_addr<sp/>(dma_chan,<sp/>adc_buffer,<sp/><sp/><sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="233"><highlight class="normal"><sp/><sp/><sp/><sp/>dma_channel_set_trans_count(dma_chan,<sp/><ref refid="_atividade__05_8c_1ad0c329adebc27917fc0a4f51079acf6a" kindref="member">SAMPLES</ref>,<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="234"><highlight class="normal">}</highlight></codeline>
<codeline lineno="235"><highlight class="normal"></highlight></codeline>
<codeline lineno="241"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>display_temperature(</highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>temp_c)<sp/>{</highlight></codeline>
<codeline lineno="242"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>line1[]<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;Manoel<sp/>Ativ<sp/>05&quot;</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="243"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>line2[]<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;&quot;</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="244"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>line3[]<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;Temperatura&quot;</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="245"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>line4[]<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;Media&quot;</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="246"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>line5[32];</highlight></codeline>
<codeline lineno="247"><highlight class="normal"><sp/><sp/><sp/><sp/>snprintf(line5,<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(line5),<sp/></highlight><highlight class="stringliteral">&quot;<sp/><sp/><sp/><sp/><sp/><sp/><sp/>%.2f<sp/>C&quot;</highlight><highlight class="normal">,<sp/>temp_c);</highlight></codeline>
<codeline lineno="248"><highlight class="normal"></highlight></codeline>
<codeline lineno="249"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="250"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Limpa<sp/>framebuffer,<sp/>desenha<sp/>texto<sp/>nas<sp/>coordenadas<sp/>(0,0)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="251"><highlight class="normal"><sp/><sp/><sp/><sp/>memset(fb,<sp/>0,<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(fb));<sp/></highlight><highlight class="comment">//<sp/>ou<sp/>ssd1306_clear();<sp/>já<sp/>explicado</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="252"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="253"><highlight class="normal"></highlight></codeline>
<codeline lineno="254"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Desenha<sp/>cada<sp/>linha<sp/>em<sp/>pixels<sp/>(altura<sp/>da<sp/>fonte<sp/>=<sp/>8<sp/>px)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="255"><highlight class="normal"><sp/><sp/><sp/><sp/>ssd1306_draw_string(fb,<sp/>0,<sp/>0,<sp/><sp/>line1);<sp/><sp/></highlight><highlight class="comment">//<sp/>primeira<sp/>linha</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="256"><highlight class="normal"><sp/><sp/><sp/><sp/>ssd1306_draw_string(fb,<sp/>0,<sp/>8,<sp/><sp/>line2);<sp/><sp/></highlight><highlight class="comment">//<sp/>segunda<sp/>linha<sp/>(8<sp/>px<sp/>abaixo)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="257"><highlight class="normal"><sp/><sp/><sp/><sp/>ssd1306_draw_string(fb,<sp/>0,<sp/>16,<sp/>line3);<sp/><sp/></highlight><highlight class="comment">//<sp/>terceira<sp/>linha<sp/>(16<sp/>px<sp/>abaixo)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="258"><highlight class="normal"><sp/><sp/><sp/><sp/>ssd1306_draw_string(fb,<sp/>0,<sp/>24,<sp/>line4);<sp/><sp/></highlight><highlight class="comment">//<sp/>quarta<sp/>linha<sp/>(24<sp/>px<sp/>abaixo)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="259"><highlight class="normal"><sp/><sp/><sp/><sp/>ssd1306_draw_string(fb,<sp/>0,<sp/>32,<sp/>line5);<sp/><sp/></highlight><highlight class="comment">//<sp/>quinta<sp/>linha<sp/>(32<sp/>px<sp/>abaixo)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="260"><highlight class="normal"></highlight></codeline>
<codeline lineno="261"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Envia<sp/>buffer<sp/>para<sp/>o<sp/>display</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="262"><highlight class="normal"><sp/><sp/><sp/><sp/>render_on_display(fb,<sp/>&amp;full_area);<sp/></highlight><highlight class="comment">//<sp/>ou<sp/>ssd1306_show();<sp/>já<sp/>explicado</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="263"><highlight class="normal">}</highlight></codeline>
<codeline lineno="264"><highlight class="normal"></highlight></codeline>
<codeline lineno="265"><highlight class="normal"></highlight><highlight class="comment">/*<sp/>------------------------------<sp/>Função<sp/>main<sp/>-------------------------------<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="266"><highlight class="normal"></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>main(</highlight><highlight class="keywordtype">void</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="267"><highlight class="normal">{</highlight></codeline>
<codeline lineno="268"><highlight class="normal"><sp/><sp/><sp/><sp/>stdio_init_all();<sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Para<sp/>debug<sp/>via<sp/>USB<sp/>(pode<sp/>ser<sp/>removido<sp/>em<sp/>produção)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="269"><highlight class="normal"></highlight></codeline>
<codeline lineno="270"><highlight class="normal"><sp/><sp/><sp/><sp/>init_display();<sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>I2C<sp/>+<sp/>OLED</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="271"><highlight class="normal"><sp/><sp/><sp/><sp/>init_adc();<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>ADC<sp/>contínuo<sp/>no<sp/>canal<sp/>4<sp/>(sensor<sp/>interno)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="272"><highlight class="normal"><sp/><sp/><sp/><sp/>init_dma();<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Canal<sp/>DMA<sp/>configurado</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="273"><highlight class="normal"></highlight></codeline>
<codeline lineno="274"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Primeira<sp/>execução<sp/>de<sp/>DMA<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="275"><highlight class="normal"><sp/><sp/><sp/><sp/>restart_dma();</highlight></codeline>
<codeline lineno="276"><highlight class="normal"></highlight></codeline>
<codeline lineno="277"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keyword">true</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="278"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="279"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Aguarda<sp/>DMA<sp/>preencher<sp/>o<sp/>buffer<sp/>(modo<sp/>bloqueante,<sp/>mas<sp/>CPU<sp/>pode</highlight></codeline>
<codeline lineno="280"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*<sp/>ser<sp/>colocada<sp/>em<sp/>espera<sp/>se<sp/>desejar).</highlight></codeline>
<codeline lineno="281"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*<sp/>Bloqueia<sp/>até<sp/>o<sp/>DMA<sp/>preencher<sp/>o<sp/>buffer.<sp/>Em<sp/>projetos<sp/>mais<sp/>avançados</highlight></codeline>
<codeline lineno="282"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*<sp/>pode‑se<sp/>colocar<sp/>o<sp/>núcleo<sp/>em<sp/>`sleep_until()`<sp/>ou<sp/>usar<sp/>IRQs.<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="283"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dma_channel_wait_for_finish_blocking(dma_chan);</highlight></codeline>
<codeline lineno="284"><highlight class="normal"></highlight></codeline>
<codeline lineno="285"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>--------------------<sp/>Processa<sp/>amostras<sp/>-------------------------<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="286"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>uint32_t<sp/>sum<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="287"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keywordtype">size_t</highlight><highlight class="normal"><sp/>i<sp/>=<sp/>0;<sp/>i<sp/>&lt;<sp/><ref refid="_atividade__05_8c_1ad0c329adebc27917fc0a4f51079acf6a" kindref="member">SAMPLES</ref>;<sp/>++i)</highlight></codeline>
<codeline lineno="288"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>sum<sp/>+=<sp/>adc_buffer[i]<sp/>&amp;<sp/>0x0FFF;<sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>12 bits<sp/>válidos</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="289"><highlight class="normal"></highlight></codeline>
<codeline lineno="290"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>uint16_t<sp/>raw_avg<sp/>=<sp/>sum<sp/>/<sp/><ref refid="_atividade__05_8c_1ad0c329adebc27917fc0a4f51079acf6a" kindref="member">SAMPLES</ref>;<sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Média<sp/>aritmética</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="291"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>temperature<sp/>=<sp/>adc_to_celsius(raw_avg);</highlight></codeline>
<codeline lineno="292"><highlight class="normal"></highlight></codeline>
<codeline lineno="293"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>display_temperature(temperature);</highlight></codeline>
<codeline lineno="294"><highlight class="normal"></highlight></codeline>
<codeline lineno="295"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Prepara<sp/>o<sp/>próximo<sp/>ciclo<sp/>-<sp/>para<sp/>novo<sp/>bloco<sp/>e<sp/>aguarda<sp/>próximo<sp/>período<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="296"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>restart_dma();</highlight></codeline>
<codeline lineno="297"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>sleep_ms(<ref refid="_atividade__05_8c_1ae2377e1385d49cf9c9ba44a8d07c94db" kindref="member">TEMP_UPDATE_MS</ref>);</highlight></codeline>
<codeline lineno="298"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="299"><highlight class="normal">}</highlight></codeline>
    </programlisting>
    <location file="C:/Users/manoe/OneDrive/TI/EmbarcaTech/Segunda Fase/01_Unid.01_Microcontrolador/Atividades/Cap_05/Atividade_05/src/Atividade_05.c"/>
  </compounddef>
</doxygen>
