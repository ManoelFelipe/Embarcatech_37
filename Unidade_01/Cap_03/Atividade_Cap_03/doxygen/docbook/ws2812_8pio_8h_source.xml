<?xml version='1.0' encoding='UTF-8' standalone='no'?>
<section xmlns="http://docbook.org/ns/docbook" version="5.0" xmlns:xlink="http://www.w3.org/1999/xlink" xml:id="_ws2812_8pio_8h_source" xml:lang="en-US">
<title>ws2812.pio.h</title>
<programlisting linenumbering="unnumbered">1 <emphasis role="comment">//&#32;--------------------------------------------------&#32;//</emphasis>
2 <emphasis role="comment">//&#32;This&#32;file&#32;is&#32;autogenerated&#32;by&#32;pioasm;&#32;do&#32;not&#32;edit!&#32;//</emphasis>
3 <emphasis role="comment">//&#32;--------------------------------------------------&#32;//</emphasis>
4 
5 <emphasis role="preprocessor">#pragma&#32;once</emphasis>
6 
7 <emphasis role="preprocessor">#if&#32;!PICO_NO_HARDWARE</emphasis>
8 <emphasis role="preprocessor">#include&#32;&quot;hardware/pio.h&quot;</emphasis>
9 <emphasis role="preprocessor">#endif</emphasis>
10 
11 <emphasis role="comment">//&#32;------&#32;//</emphasis>
12 <emphasis role="comment">//&#32;ws2812&#32;//</emphasis>
13 <emphasis role="comment">//&#32;------&#32;//</emphasis>
14 
15 <emphasis role="preprocessor">#define&#32;ws2812_wrap_target&#32;0</emphasis>
16 <emphasis role="preprocessor">#define&#32;ws2812_wrap&#32;3</emphasis>
17 <emphasis role="preprocessor">#define&#32;ws2812_pio_version&#32;0</emphasis>
18 
19 <emphasis role="preprocessor">#define&#32;ws2812_T1&#32;3</emphasis>
20 <emphasis role="preprocessor">#define&#32;ws2812_T2&#32;3</emphasis>
21 <emphasis role="preprocessor">#define&#32;ws2812_T3&#32;4</emphasis>
22 
23 <emphasis role="keyword">static</emphasis>&#32;<emphasis role="keyword">const</emphasis>&#32;uint16_t&#32;ws2812_program_instructions[]&#32;=&#32;{
24 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="comment">//&#32;&#32;&#32;&#32;&#32;.wrap_target</emphasis>
25 &#32;&#32;&#32;&#32;0x6321,&#32;<emphasis role="comment">//&#32;&#32;0:&#32;out&#32;&#32;&#32;&#32;x,&#32;1&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;side&#32;0&#32;[3]</emphasis>
26 &#32;&#32;&#32;&#32;0x1223,&#32;<emphasis role="comment">//&#32;&#32;1:&#32;jmp&#32;&#32;&#32;&#32;!x,&#32;3&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;side&#32;1&#32;[2]</emphasis>
27 &#32;&#32;&#32;&#32;0x1200,&#32;<emphasis role="comment">//&#32;&#32;2:&#32;jmp&#32;&#32;&#32;&#32;0&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;side&#32;1&#32;[2]</emphasis>
28 &#32;&#32;&#32;&#32;0xa242,&#32;<emphasis role="comment">//&#32;&#32;3:&#32;nop&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;side&#32;0&#32;[2]</emphasis>
29 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="comment">//&#32;&#32;&#32;&#32;&#32;.wrap</emphasis>
30 };
31 
32 <emphasis role="preprocessor">#if&#32;!PICO_NO_HARDWARE</emphasis>
33 <emphasis role="keyword">static</emphasis>&#32;<emphasis role="keyword">const</emphasis>&#32;<emphasis role="keyword">struct&#32;</emphasis>pio_program&#32;ws2812_program&#32;=&#32;{
34 &#32;&#32;&#32;&#32;.instructions&#32;=&#32;ws2812_program_instructions,
35 &#32;&#32;&#32;&#32;.length&#32;=&#32;4,
36 &#32;&#32;&#32;&#32;.origin&#32;=&#32;-1,
37 &#32;&#32;&#32;&#32;.pio_version&#32;=&#32;ws2812_pio_version,
38 <emphasis role="preprocessor">#if&#32;PICO_PIO_VERSION&#32;&gt;&#32;0</emphasis>
39 &#32;&#32;&#32;&#32;.used_gpio_ranges&#32;=&#32;0x0
40 <emphasis role="preprocessor">#endif</emphasis>
41 };
42 
43 <emphasis role="keyword">static</emphasis>&#32;<emphasis role="keyword">inline</emphasis>&#32;pio_sm_config&#32;ws2812_program_get_default_config(uint&#32;offset)&#32;{
44 &#32;&#32;&#32;&#32;pio_sm_config&#32;c&#32;=&#32;pio_get_default_sm_config();
45 &#32;&#32;&#32;&#32;sm_config_set_wrap(&amp;c,&#32;offset&#32;+&#32;ws2812_wrap_target,&#32;offset&#32;+&#32;ws2812_wrap);
46 &#32;&#32;&#32;&#32;sm_config_set_sideset(&amp;c,&#32;1,&#32;<emphasis role="keyword">false</emphasis>,&#32;<emphasis role="keyword">false</emphasis>);
47 &#32;&#32;&#32;&#32;<emphasis role="keywordflow">return</emphasis>&#32;c;
48 }
49 
50 <emphasis role="preprocessor">#include&#32;&quot;hardware/clocks.h&quot;</emphasis>
51 <emphasis role="keyword">static</emphasis>&#32;<emphasis role="keyword">inline</emphasis>&#32;<emphasis role="keywordtype">void</emphasis>&#32;ws2812_program_init(PIO&#32;pio,&#32;uint&#32;sm,&#32;uint&#32;offset,&#32;uint&#32;pin,&#32;<emphasis role="keywordtype">float</emphasis>&#32;freq,&#32;<emphasis role="keywordtype">bool</emphasis>&#32;rgbw)&#32;{
52 &#32;&#32;&#32;&#32;pio_gpio_init(pio,&#32;pin);
53 &#32;&#32;&#32;&#32;pio_sm_set_consecutive_pindirs(pio,&#32;sm,&#32;pin,&#32;1,&#32;<emphasis role="keyword">true</emphasis>);
54 &#32;&#32;&#32;&#32;pio_sm_config&#32;c&#32;=&#32;ws2812_program_get_default_config(offset);
55 &#32;&#32;&#32;&#32;sm_config_set_sideset_pins(&amp;c,&#32;pin);
56 &#32;&#32;&#32;&#32;sm_config_set_out_shift(&amp;c,&#32;<emphasis role="keyword">false</emphasis>,&#32;<emphasis role="keyword">true</emphasis>,&#32;rgbw&#32;?&#32;32&#32;:&#32;24);
57 &#32;&#32;&#32;&#32;sm_config_set_fifo_join(&amp;c,&#32;PIO_FIFO_JOIN_TX);
58 &#32;&#32;&#32;&#32;<emphasis role="keywordtype">int</emphasis>&#32;cycles_per_bit&#32;=&#32;ws2812_T1&#32;+&#32;ws2812_T2&#32;+&#32;ws2812_T3;
59 &#32;&#32;&#32;&#32;<emphasis role="keywordtype">float</emphasis>&#32;div&#32;=&#32;clock_get_hz(clk_sys)&#32;/&#32;(freq&#32;*&#32;cycles_per_bit);
60 &#32;&#32;&#32;&#32;sm_config_set_clkdiv(&amp;c,&#32;div);
61 &#32;&#32;&#32;&#32;pio_sm_init(pio,&#32;sm,&#32;offset,&#32;&amp;c);
62 &#32;&#32;&#32;&#32;pio_sm_set_enabled(pio,&#32;sm,&#32;<emphasis role="keyword">true</emphasis>);
63 }
64 
65 <emphasis role="preprocessor">#endif</emphasis>
66 
67 <emphasis role="comment">//&#32;---------------&#32;//</emphasis>
68 <emphasis role="comment">//&#32;ws2812_parallel&#32;//</emphasis>
69 <emphasis role="comment">//&#32;---------------&#32;//</emphasis>
70 
71 <emphasis role="preprocessor">#define&#32;ws2812_parallel_wrap_target&#32;0</emphasis>
72 <emphasis role="preprocessor">#define&#32;ws2812_parallel_wrap&#32;3</emphasis>
73 <emphasis role="preprocessor">#define&#32;ws2812_parallel_pio_version&#32;0</emphasis>
74 
75 <emphasis role="preprocessor">#define&#32;ws2812_parallel_T1&#32;3</emphasis>
76 <emphasis role="preprocessor">#define&#32;ws2812_parallel_T2&#32;3</emphasis>
77 <emphasis role="preprocessor">#define&#32;ws2812_parallel_T3&#32;4</emphasis>
78 
79 <emphasis role="keyword">static</emphasis>&#32;<emphasis role="keyword">const</emphasis>&#32;uint16_t&#32;ws2812_parallel_program_instructions[]&#32;=&#32;{
80 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="comment">//&#32;&#32;&#32;&#32;&#32;.wrap_target</emphasis>
81 &#32;&#32;&#32;&#32;0x6020,&#32;<emphasis role="comment">//&#32;&#32;0:&#32;out&#32;&#32;&#32;&#32;x,&#32;32</emphasis>
82 &#32;&#32;&#32;&#32;0xa20b,&#32;<emphasis role="comment">//&#32;&#32;1:&#32;mov&#32;&#32;&#32;&#32;pins,&#32;~null&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;[2]</emphasis>
83 &#32;&#32;&#32;&#32;0xa201,&#32;<emphasis role="comment">//&#32;&#32;2:&#32;mov&#32;&#32;&#32;&#32;pins,&#32;x&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;[2]</emphasis>
84 &#32;&#32;&#32;&#32;0xa203,&#32;<emphasis role="comment">//&#32;&#32;3:&#32;mov&#32;&#32;&#32;&#32;pins,&#32;null&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;[2]</emphasis>
85 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="comment">//&#32;&#32;&#32;&#32;&#32;.wrap</emphasis>
86 };
87 
88 <emphasis role="preprocessor">#if&#32;!PICO_NO_HARDWARE</emphasis>
89 <emphasis role="keyword">static</emphasis>&#32;<emphasis role="keyword">const</emphasis>&#32;<emphasis role="keyword">struct&#32;</emphasis>pio_program&#32;ws2812_parallel_program&#32;=&#32;{
90 &#32;&#32;&#32;&#32;.instructions&#32;=&#32;ws2812_parallel_program_instructions,
91 &#32;&#32;&#32;&#32;.length&#32;=&#32;4,
92 &#32;&#32;&#32;&#32;.origin&#32;=&#32;-1,
93 &#32;&#32;&#32;&#32;.pio_version&#32;=&#32;ws2812_parallel_pio_version,
94 <emphasis role="preprocessor">#if&#32;PICO_PIO_VERSION&#32;&gt;&#32;0</emphasis>
95 &#32;&#32;&#32;&#32;.used_gpio_ranges&#32;=&#32;0x0
96 <emphasis role="preprocessor">#endif</emphasis>
97 };
98 
99 <emphasis role="keyword">static</emphasis>&#32;<emphasis role="keyword">inline</emphasis>&#32;pio_sm_config&#32;ws2812_parallel_program_get_default_config(uint&#32;offset)&#32;{
100 &#32;&#32;&#32;&#32;pio_sm_config&#32;c&#32;=&#32;pio_get_default_sm_config();
101 &#32;&#32;&#32;&#32;sm_config_set_wrap(&amp;c,&#32;offset&#32;+&#32;ws2812_parallel_wrap_target,&#32;offset&#32;+&#32;ws2812_parallel_wrap);
102 &#32;&#32;&#32;&#32;<emphasis role="keywordflow">return</emphasis>&#32;c;
103 }
104 
105 <emphasis role="preprocessor">#include&#32;&quot;hardware/clocks.h&quot;</emphasis>
106 <emphasis role="keyword">static</emphasis>&#32;<emphasis role="keyword">inline</emphasis>&#32;<emphasis role="keywordtype">void</emphasis>&#32;ws2812_parallel_program_init(PIO&#32;pio,&#32;uint&#32;sm,&#32;uint&#32;offset,&#32;uint&#32;pin_base,&#32;uint&#32;pin_count,&#32;<emphasis role="keywordtype">float</emphasis>&#32;freq)&#32;{
107 &#32;&#32;&#32;&#32;<emphasis role="keywordflow">for</emphasis>(uint&#32;i=pin_base;&#32;i&lt;pin_base+pin_count;&#32;i++)&#32;{
108 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;pio_gpio_init(pio,&#32;i);
109 &#32;&#32;&#32;&#32;}
110 &#32;&#32;&#32;&#32;pio_sm_set_consecutive_pindirs(pio,&#32;sm,&#32;pin_base,&#32;pin_count,&#32;<emphasis role="keyword">true</emphasis>);
111 &#32;&#32;&#32;&#32;pio_sm_config&#32;c&#32;=&#32;ws2812_parallel_program_get_default_config(offset);
112 &#32;&#32;&#32;&#32;sm_config_set_out_shift(&amp;c,&#32;<emphasis role="keyword">true</emphasis>,&#32;<emphasis role="keyword">true</emphasis>,&#32;32);
113 &#32;&#32;&#32;&#32;sm_config_set_out_pins(&amp;c,&#32;pin_base,&#32;pin_count);
114 &#32;&#32;&#32;&#32;sm_config_set_fifo_join(&amp;c,&#32;PIO_FIFO_JOIN_TX);
115 &#32;&#32;&#32;&#32;<emphasis role="keywordtype">int</emphasis>&#32;cycles_per_bit&#32;=&#32;ws2812_parallel_T1&#32;+&#32;ws2812_parallel_T2&#32;+&#32;ws2812_parallel_T3;
116 &#32;&#32;&#32;&#32;<emphasis role="keywordtype">float</emphasis>&#32;div&#32;=&#32;clock_get_hz(clk_sys)&#32;/&#32;(freq&#32;*&#32;cycles_per_bit);
117 &#32;&#32;&#32;&#32;sm_config_set_clkdiv(&amp;c,&#32;div);
118 &#32;&#32;&#32;&#32;pio_sm_init(pio,&#32;sm,&#32;offset,&#32;&amp;c);
119 &#32;&#32;&#32;&#32;pio_sm_set_enabled(pio,&#32;sm,&#32;<emphasis role="keyword">true</emphasis>);
120 }
121 
122 <emphasis role="preprocessor">#endif</emphasis>
</programlisting></section>
